
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Design\Concrete\GetSummaryResultsJoint.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetSummaryResultsJoint</title>
<link rel="stylesheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>GetSummaryResultsJoint</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.DesignConcrete.GetSummaryResultsJoint</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetSummaryResultsJoint(ByVal Name As String, ByRef NumberItems As Long, ByRef FrameName() As String, ByRef LCJSRatioMajor() As String, ByRef JSRatioMajor() As Double, ByRef LCJSRatioMinor() As String, ByRef JSRatioMinor() As Double, ByRef LCBCCRatioMajor() As String, ByRef BCCRatioMajor() As Double, ByRef LCBCCRatioMinor() As String, ByRef BCCRatioMinor() As Double, ByRef ErrorSummary() As String, ByRef WarningSummary() As String, Optional ByVal ItemType As eItemType = Object) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing frame object or group, depending on the value of the ItemType item.</p>
<p class="ParameterName">NumberItems</p>
<p class="Comment">The number of frame objects for which results are obtained.</p>
<p class="ParameterName">FrameName</p>
<p class="Comment">This is an array that includes each frame object name for which results are obtained.</p>
<p class="ParameterName">LCJSRatioMajor</p>
<p class="Comment">This is an array that includes the name of the design combination for which the controlling joint shear ratio associated with the column major axis occurs. A combination name followed by (Sp) indicates that the design loads were obtained by applying special, code-specific multipliers to all or part of the specified design load combination, or that the design was based on the capacity of other objects (or other design locations for the same object).</p>
<p class="ParameterName">JSRatioMajor</p>
<p class="Comment">This is an array that includes the joint shear ratio associated with the column major axis. This is the joint shear divided by the joint shear capacity.</p>
<p class="ParameterName">LCJSRatioMinor</p>
<p class="Comment">This is an array that includes the name of the design combination for which the controlling joint shear ratio associated with the column minor axis occurs. A combination name followed by (Sp) indicates that the design loads were obtained by applying special, code-specific multipliers to all or part of the specified design load combination, or that the design was based on the capacity of other objects (or other design locations for the same object).</p>
<p class="ParameterName">JSRatioMinor</p>
<p class="Comment">This is an array that includes the joint shear ratio associated with the column minor axis. This is the joint shear divided by the joint shear capacity.</p>
<p class="ParameterName">LCBCCRatioMajor</p>
<p class="Comment">This is an array that includes the name of the design combination for which the controlling beam/column capacity ratio associated with the column major axis occurs. A combination name followed by (Sp) indicates that the design loads were obtained by applying special, code-specific multipliers to all or part of the specified design load combination, or that the design was based on the capacity of other objects (or other design locations for the same object).</p>
<p class="ParameterName">BCCRatioMajor</p>
<p class="Comment">This is an array that includes the beam/column capacity ratio associated with the column major axis. This is the sum of the column capacities divided by the sum of the beam capacities at the top of the specified column.</p>
<p class="ParameterName">LCBCCRatioMinor</p>
<p class="Comment">This is an array that includes the name of the design combination for which the controlling beam/column capacity ratio associated with the column minor axis occurs. A combination name followed by (Sp) indicates that the design loads were obtained by applying special, code-specific multipliers to all or part of the specified design load combination, or that the design was based on the capacity of other objects (or other design locations for the same object).</p>
<p class="ParameterName">BCCRatioMinor</p>
<p class="Comment">This is an array that includes the beam/column capacity ratio associated with the column minor axis. This is the sum of the column capacities divided by the sum of the beam capacities at the top of the specified column.</p>
<p class="ParameterName">ErrorSummary</p>
<p class="Comment">This is an array that includes the design error messages for the frame object, if any.</p>
<p class="ParameterName">WarningSummary</p>
<p class="Comment">This is an array that includes the design warning messages for the frame object, if any.</p>
<p class="ParameterName">ItemType</p>
<p class="Comment">This is one of the following items in the eItemType enumeration:</p>
<p class="ParameterDescription" style="margin-bottom: .0001pt; margin-left: 88px;">Object = 0</p>
<p class="ParameterDescription" style="margin-bottom: .0001pt; margin-left: 88px;">Group = 1</p>
<p class="ParameterDescription" style="margin-bottom: .0001pt; margin-left: 88px;">SelectedObjects = 2</p>
<p class="ParameterDescription" style="margin-top: 0pt; margin-right: 0pt; margin-bottom: .0001pt; margin-left: 36.0pt;">&#160;</p>
<p class="Comment">If this item is Object, the design results are retrieved for the frame object specified by the Name item.</p>
<p class="Comment">If this item is Group, the design results are retrieved for all frame objects in the group specified by the Name item.</p>
<p class="Comment">If this item is SelectedObjects, the design results are retrieved for all selected frame objects, and the Name item is ignored.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves summary results for concrete design.</p>
<p class="Comment">The function returns zero if the results are successfully retrieved; otherwise it returns a nonzero value.</p>
<p class="Comment">Note that joint design is only included for some codes.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetConcreteJointDesignSummaryResults()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Name As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NumberItems As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim FrameName() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LCJSRatioMajor() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim JSRatioMajor() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LCJSRatioMinor() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim JSRatioMinor() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LCBCCRatioMajor() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim BCCRatioMajor() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LCBCCRatioMinor() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim BCCRatioMinor() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ErrorSummary() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim WarningSummary() As String<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'add ASTM A706 rebar material<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PropMaterial.AddQuick(Name, MATERIAL_REBAR, , , , , MATERIAL_REBAR_SUBTYPE_ASTM_A706)<br>
<br>
&#160;&#160;&#160;'create new concrete frame section properties<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PropFrame.SetRectangle("COL", "4000Psi", 20, 20)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PropFrame.SetRectangle("BEAM", "4000Psi", 20, 12)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PropFrame.SetRebarBeam("BEAM", Name, Name, 2, 2, 2, 2, 2, 2)<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288, True, "BEAM", "COL")<br>
<br>
&#160;&#160;&#160;'add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)<br>
<br>
&#160;&#160;&#160;'assign IBC2003 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2003("EQX", 1, 0.05, 1, 0.035, 0, False, 0, 0, 1, 1, 3, 1, 0.4, 0, 0, 8, 3, 5.5)<br>
<br>
&#160;&#160;&#160;'set concrete design code<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.DesignConcrete.SetCode("ACI 318-02")<br>
<br>
&#160;&#160;&#160;'run analysis<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.Save("C:\SapAPI\x.sdb")<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.Analyze.RunAnalysis<br>
<br>
&#160;&#160;&#160;'start concrete design<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.DesignConcrete.StartDesign<br>
<br>
&#160;&#160;&#160;'get summary result data<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.DesignConcrete.GetSummaryResultsJoint("3", NumberItems, FrameName, LCJSRatioMajor, JSRatioMajor, LCJSRatioMinor, JSRatioMinor, LCBCCRatioMajor, BCCRatioMajor, LCBCCRatioMinor, BCCRatioMinor, ErrorSummary, WarningSummary)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.03.</p>
<p class="Comment">Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load Patterns, Load Cases and Load Combinations, respectively, in version 12.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetSummaryResultsBeam.htm">GetSummaryResultsBeam</a></p>
<p class="Block-Text"><a href="GetSummaryResultsColumn.htm">GetSummaryResultsColumn</a></p>
</body>
</html>
