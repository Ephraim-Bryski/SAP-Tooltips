
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetFrameForce</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>SetFrameForce</h1>
<h2>Syntax</h2>
<p class="parameterdescription" style="margin-left: .5in;">SapObject.SapModel.ExternalAnalysisResults.SetFrameForce</p>
<h2>VB6 Procedure</h2>
<p class="ParameterNameDescription">Function SetFrameForce(ByVal Name As String, ByVal InitialCase As String, ByVal StepNum As Long, ByRef P() As Double, ByRef V2() As Double, ByRef V3() As Double, ByRef T() As Double, ByRef M2() As Double, ByRef M3() As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterNameDescription" style="font-weight: bold; margin-bottom: 0pt;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">Name</span></span></p>
<p class="parameterdescription" style="margin-left: .5in;"><span lang="X-NONE" xml:lang="X-NONE">The name of an existing frame object.</span></p>
<p class="ParameterNameDescription" style="font-weight: bold; margin-bottom: 0pt;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">InitialCase</span></span></p>
<p class="parameterdescription" style="margin-left: .5in;"><span lang="X-NONE" xml:lang="X-NONE">The name of an existing external results load case for which user-supplied external analysis results relevant to the object are available.</span></p>
<p class="ParameterNameDescription" style="font-weight: bold; margin-bottom: 0pt;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">StepNum</span></span></p>
<p class="parameterdescription" style="margin-left: .5in;"><span lang="X-NONE" xml:lang="X-NONE">The zero based index of a load case step: 0 for the first step, 1 for the second, and so on.</span></p>
<p class="ParameterNameDescription" style="font-weight: bold; margin-bottom: 0pt;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">P, V2, V3</span></span></p>
<p class="parameterdescription" style="margin-left: .5in; font-weight: normal;"><span lang="X-NONE" xml:lang="X-NONE">These are one dimensional arrays that include the axial force, shear force in the local 2 direction, and shear force in the local 3 direction, respectively, for each frame station.[F] These arrays are each expected to contain a number of values equal to the</span><span lang="X-NONE" xml:lang="X-NONE" style="mso-spacerun: yes;">&#160;</span><span lang="X-NONE" xml:lang="X-NONE">&#160;previously declared number of stations at which external results are available for the object – see SapObject.SapModel.ExternalAnalysisResults.SetFrameStations() for that declaration.</span> <span lang="X-NONE" xml:lang="X-NONE" style="mso-spacerun: yes;">&#160;</span></p>
<p class="parameterdescription" style="margin-left: .5in; font-weight: normal;"><span lang="X-NONE" xml:lang="X-NONE">If any of these arrays is empty, the function substitutes zero values for the missing values.</span></p>
<p class="ParameterNameDescription" style="font-weight: bold; margin-bottom: 0pt;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">T, M2, M3</span></span></p>
<p class="parameterdescription" style="margin-left: .5in; font-weight: normal;"><span lang="X-NONE" xml:lang="X-NONE">These are one dimensional arrays that include the torsion, moment about the local 2axis, and moment about the local 3-axis, respectively, for each frame station. [FL] Again, these arrays are each expected to contain a number of values equal to the</span><span lang="X-NONE" xml:lang="X-NONE" style="mso-spacerun: yes;">&#160;</span><span lang="X-NONE" xml:lang="X-NONE">&#160;previously declared number of stations at which external results are provided for the object. If any of these arrays is empty, the function substitutes zero values for the missing values.</span></p>
<h2><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">Remarks</span></span></h2>
<p class="parameterdescription" style="margin-left: .5in;"><span lang="X-NONE" xml:lang="X-NONE">This function sets the external result forces for a given step of a given external results load case on a frame object.</span></p>
<p class="parameterdescription" style="margin-left: .5in;"><span lang="X-NONE" xml:lang="X-NONE">The function returns zero if the forces are successfully set, otherwise it returns a nonzero value.</span></p>
<h2><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">VBA Example</span></span></h2>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 48px; font-size: 10.0pt; font-family: 'Courier New';"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">Sub SetFrameExternalResultForces ()</span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 48px;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;</span>&#160;'dimension variables</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim SapObject As Sap2000v16.SapObject</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim SapModel As cSapModel</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim ret As Long</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim ObjSta() As Double = New Double() {0.0, 124.0}</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim LoadCase() As String = New String() {"EXTERNAL"}<span style="mso-spacerun: yes;">&#160;&#160;&#160;</span></span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim P() As Double = New Double() {5.0, 5.0}</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim V2() As Double = New Double() {-5.0, 5.0}</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim V3() As Double = Nothing</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim T() As Double = Nothing</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim M2() As Double = Nothing</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim M3() As Double = New Double() {100.0, 100.0}</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create Sap2000 object</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapObject = New Sap2000v16.SapObject</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'start Sap2000 application</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapObject.ApplicationStart()</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create SapModel object</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapModel = SapObject.SapModel</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'initialize model</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.InitializeNewModel</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create model from template</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;</span>&#160;<span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span>ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124, 3, 200)</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create load case for external results</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'set cases and stations for frame external results</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1, LoadCase)</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.ExternalAnalysisResults.SetFrameStations("1", ObjSta)</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'set frame external result forces at case first step</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.ExternalAnalysisResults.SetFrameForce("1", "EXTERNAL", 0, P, V2, V3, T, M2, M3)</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'close Sap2000</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapObject.ApplicationExit(False)</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapModel = Nothing</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 60px;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style="font-size: 10.0pt; font-family: 'Courier New';">&#160;SapObject = Nothing</span></span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 60px;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;"><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE"><span style="font-size: 10.0pt; font-family: 'Courier New';"><span style="mso-spacerun: yes;">&#160;&#160;&#160;</span>&#160;End Sub</span></span></span></p>
<h2><span style="font-weight: bold;"><span lang="X-NONE" xml:lang="X-NONE">Release Notes</span></span></h2>
<p class="Comment" style="font-size: 10pt;"><span lang="X-NONE" xml:lang="X-NONE">Initial release in version 16.00.</span></p>
</body>
</html>
