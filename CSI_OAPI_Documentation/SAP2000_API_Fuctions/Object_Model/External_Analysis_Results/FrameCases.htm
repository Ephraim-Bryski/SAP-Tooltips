
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>PresetFrameCases</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>PresetFrameCases</h1>
<h2>Syntax</h2>
<p class="parameterdescription" style="margin-left: .5in;">SapObject.SapModel.ExternalAnalysisResults.PresetFrameCases</p>
<h2>VB6 Procedure</h2>
<p class="Comment" style="font-size: 10pt;">Function PresetFrameCases(Name As String, ByVal Count As Long, ByRef casname() As String) As Long</p>
<h2>Parameters</h2>
<p class="parametername" style="margin-left: .5in;">Name</p>
<p class="parameterdescription" style="margin-left: .5in;">The name of an existing frame object.</p>
<p class="parametername" style="margin-left: .5in;">Count</p>
<p class="parameterdescription" style="margin-left: .5in;">The length of the subsequent array.</p>
<p class="parametername" style="margin-left: .5in;">casename</p>
<p class="parameterdescription" style="margin-left: .5in;">An array listing the names of previously defined external result load cases for which user-supplied external analysis results are available for the frame object.</p>
<h2>Remarks</h2>
<p class="parameterdescription" style="margin-left: .5in;">Calling this function is optional, but it can speed up subsequent assignment of external analysis results which are available for more than one load case.</p>
<p class="parameterdescription" style="margin-left: .5in;">The first time this function is called for a particular frame object, it sets the list of names of external result load cases for which results relevant to the object are available. Subsequent calls to this function for the same object reset the results for load cases already in the list, and add load cases not already in.</p>
<p class="parameterdescription" style="margin-left: .5in;">This function returns zero if the stations are successfully set, otherwise it returns a nonzero value.</p>
<h2><span lang="ES-MX" xml:lang="ES-MX" style="mso-ansi-language: ES-MX;">VBA Example</span></h2>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 48px;"><span lang="ES-MX" xml:lang="ES-MX" style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas; mso-ansi-language: ES-MX;">Sub</span> <span lang="ES-MX" xml:lang="ES-MX" style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas; mso-ansi-language: ES-MX;">PresetFrameExternalCases</span><span lang="ES-MX" xml:lang="ES-MX" style="font-size: 10.0pt; mso-bidi-font-size: 11.0pt; font-family: 'Courier New'; mso-bidi-font-family: 'Times New Roman'; mso-ansi-language: ES-MX;">()</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 48px;"><span lang="ES-MX" xml:lang="ES-MX" style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas; mso-ansi-language: ES-MX;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;</span>&#160;'dimension variables</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span lang="ES-MX" xml:lang="ES-MX" style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas; mso-ansi-language: ES-MX; mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;&#160;<span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;">Dim SapObject as cOAPI</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim SapModel As cSapModel</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim ret As Long</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim ObjSta() As Double = New Double() {0.0, 124.0}</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim LoadCase() As String = New String() {"EXTERNAL"}<span style="mso-spacerun: yes;">&#160;&#160;&#160;</span></span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim P() As Double = New Double() {5.0, 5.0}</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim V2() As Double = New Double() {-5.0, 5.0}</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim V3() As Double = Nothing</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim T() As Double = Nothing</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;</span>&#160;<span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span>Dim M2() As Double = Nothing</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;Dim M3() As Double = New Double() {100.0, 100.0}</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create Sap2000 object</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapObject = New Sap2000v16.SapObject</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'start Sap2000 application</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapObject.ApplicationStart()</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create SapModel object</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapModel = SapObject.SapModel</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'initialize model</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.InitializeNewModel</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create model from template</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.File.New2DFrame(e2DFrameType.PortalFrame, 3, 124, 3, 200)</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'create load case for external results</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.LoadCases.ExternalResults.SetCase("EXTERNAL")</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'set cases and stations for frame external results</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.ExternalAnalysisResults.PresetFrameCases("1", 1, LoadCase)</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.ExternalAnalysisResults.SetFrameStations("1", ObjSta)</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'set frame external result forces at case first step</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;ret = SapModel.ExternalAnalysisResults.SetFrameForce("1", "EXTERNAL", 0, P, V2, V3, T, M2, M3)</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 12px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;'close Sap2000</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapObject.ApplicationExit(False)</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 36px;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;SapModel = Nothing</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt; margin-left: 72px;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;">SapObject = Nothing</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;"><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: 'Courier New'; mso-bidi-font-family: Consolas;"><span style="mso-spacerun: yes;">&#160;&#160;&#160;</span>&#160;End Sub</span></p>
<p class="MsoNormal" style="mso-layout-grid-align: none; text-autospace: none; margin-bottom: 0pt;">&#160;</p>
<h2>Release Notes</h2>
<p class="Comment" style="font-size: 10pt;">Initial release in version 16.00.</p>
</body>
</html>
