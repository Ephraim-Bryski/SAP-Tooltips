
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Frame Object Functions\GetLoadTargetForce.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetLoadTargetForce {Frame Object}</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>GetLoadTargetForce</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.FrameObj.GetLoadTargetForce</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetLoadTargetForce(ByVal Name As String, ByRef NumberItems As Long, ByRef FrameName() As String, ByRef LoadPat() As String, ByRef dof1() As Boolean, ByRef dof2() As Boolean, ByRef dof3() As Boolean, ByRef dof4() As Boolean, ByRef dof5() As Boolean, ByRef dof6() As Boolean, ByRef P() As Double, ByRef V2() As Double, ByRef V3() As Double, ByRef T() As Double, ByRef M2() As Double, ByRef M3() As Double, ByRef T1() As Double, ByRef T2() As Double, ByRef T3() As Double, ByRef T4() As Double, ByRef T5() As Double, ByRef T6() As Double, Optional ByVal ItemType As eItemType = Object) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing frame object or group, depending on the value of the ItemType item.</p>
<p class="ParameterName">NumberItems</p>
<p class="Comment">The total number of deformation loads retrieved for the specified frame objects.</p>
<p class="ParameterName">FrameName</p>
<p class="Comment">This is an array that includes the name of the frame object associated with each target force.</p>
<p class="ParameterName">LoadPat</p>
<p class="Comment">This is an array that includes the name of the load pattern associated with each target force.</p>
<p class="ParameterName">dof1, dof2, dof3, dof4, dof5, dof6</p>
<p class="Comment">These are arrays of boolean values indicating if the considered degree of freedom has a target force assignment.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">dof1 = P</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">dof2 = V2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">dof3 = V3</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">dof4 = T</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">dof5 = M2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">dof6 = M3</p>
<p class="ParameterName">P, V2, V3, T, M2, M3</p>
<p class="Comment">These are arrays of target force values. The target forces specified for a given degree of freedom are applicable only if the corresponding DOF item for that degree of freedom is True.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">U1 = U1 deformation [L]</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">U2 = U2 deformation [L]</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">U3 = U3 deformation [L]</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">R1 = R1 deformation [rad]</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">R2 = R2 deformation [rad]</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">R3 = R3 deformation [rad]</p>
<p class="ParameterName">T1, T2, T3, T4, T5, T6</p>
<p class="ParameterDescription">These are arrays of the relative distances along the frame objects where the target force values apply. The relative distances specified for a given degree of freedom are applicable only if the corresponding dof<span style="font-style: italic;">n</span> item for that degree of freedom is True.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">T1 = relative location for P target force</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">T2 = relative location for V2 target force</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">T3 = relative location for V3 target force</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">T4 = relative location for T target force</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">T5 = relative location for M2 target force</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">T6 = relative location for M3 target force</p>
<p class="ParameterName">ItemType</p>
<p class="Comment">This is one of the following items in the eItemType enumeration:</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">Object = 0</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">Group = 1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">SelectedObjects = 2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">If this item is Object, the assignments are retrieved for the frame object specified by the Name item.</p>
<p class="Comment">If this item is Group, the assignments are retrieved for all frame objects in the group specified by the Name item.</p>
<p class="Comment">If this item is SelectedObjects, assignments are retrieved for all selected frame objects, and the Name item is ignored.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves the target force assignments to frame objects.</p>
<p class="Comment">The function returns zero if the target force assignments are successfully retrieved, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetFrameTargetForce()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim DOF() As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim f() As double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim RD() As double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NumberItems As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim FrameName() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LoadPat() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim dof1() As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim dof2() As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim dof3() As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim dof4() As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim dof5() As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim dof6() As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim P() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim V2() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim V3() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim T() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim M2() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim M3() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim T1() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim T2() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim T3() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim T4() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim T5() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim T6() As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)<br>
<br>
&#160;&#160;&#160;'assign frame target force<br>
&#160;&#160;&#160;&#160;&#160;&#160;ReDim DOF(5)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ReDim f(5)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ReDim RD(5)<br>
&#160;&#160;&#160;&#160;&#160;&#160;DOF(0) = True<br>
&#160;&#160;&#160;&#160;&#160;&#160;f(0) = 50<br>
&#160;&#160;&#160;&#160;&#160;&#160;RD(0) = 0.5<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.FrameObj.SetLoadTargetForce("1", "DEAD", DOF, f, RD)<br>
<br>
&#160;&#160;&#160;'get frame target force<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.FrameObj.GetLoadTargetForce("1", NumberItems, FrameName, LoadPat, dof1, dof2, dof3, dof4, dof5, dof6, P, V2, V3, T, M2, M3, T1, T2, T3, T4, T5, T6)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<p class="Comment">Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load Patterns, Load Cases and Load Combinations, respectively, in version 12.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetLoadTargetForce_{Frame_Object}.htm">SetLoadTargetForce</a></p>
<p class="Block-Text"><a href="DeleteLoadTargetForce_{Frame_Object}.htm">DeleteLoadTargetForce</a></p>
</body>
</html>
