
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Line Object Functions\SetSpring {Line Object}.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetSpring {Frame Object}</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>SetSpring</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.FrameObj.SetSpring</p>
<h2>VB6 Procedure</h2>
<p class="Coding">Function SetSpring(ByVal Name As String, ByVal MyType As Long, ByVal s As Double, ByVal SimpleSpringType As Long, ByVal LinkProp As String, ByVal SpringLocalOneType As Long, ByVal Dir As Long, ByVal Plane23Angle As Double, ByRef Vec() As Double, ByVal Ang As Double, ByVal Replace As Boolean, Optional ByVal CSys As String = "Local", Optional ByVal ItemType As eItemType = Object) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing frame object or group, depending on the value of the ItemType item.</p>
<p class="ParameterName">MyType</p>
<p class="Comment">This is 1 or 2, indicating the spring property type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Simple spring</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Link property</p>
<p class="ParameterName">s</p>
<p class="Comment">The simple spring stiffness per unit length of the frame object. This item applies only when MyType = 1. [F/L<sup>2</sup>]</p>
<p class="ParameterName">SimpleSpringType</p>
<p class="Comment">This is 1, 2 or 3, indicating the simple spring type. This item applies only when MyType = 1.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Spring resists tension and compression</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Spring resists compression only</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = Spring resists tension only</p>
<p class="ParameterName">LinkProp</p>
<p class="Comment">The name of the link property assigned to the spring. This item applies only when MyType = 2.</p>
<p class="ParameterName">SpringLocalOneType</p>
<p class="Comment">This is 1, 2 or 3, indicating the method used to specify the spring positive local 1-axis orientation.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Parallel to frame object local axis</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = In the frame object 2-3 plane</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = User specified direction vector</p>
<p class="ParameterName">Dir</p>
<p class="Comment">This is 1, 2, 3, -1, -2 or -3, indicating the frame object local axis that corresponds to the positive local 1-axis of the spring. This item applies only when SpringLocalOneType = 1.</p>
<p class="ParameterName">Plane23Angle</p>
<p class="Comment">This is the angle in the frame object 2-3 plane measured counter clockwise from the frame positive 2-axis to the spring positive 1-axis. This item applies only when SpringLocalOneType = 2. [deg]</p>
<p class="ParameterName">Vec</p>
<p class="Comment">This is an array of three values that define the direction vector of the spring positive local 1-axis. The direction vector is in the coordinate system specified by the CSys item. This item applies only when SpringLocalOneType = 3.</p>
<p class="ParameterName">Ang</p>
<p class="Comment">This is the angle that the link local 2-axis is rotated from its default orientation. This item applies only when MyType = 2. [deg]</p>
<p class="ParameterName">Replace</p>
<p class="Comment">If this item is True, all existing spring assignments to the frame object are removed before assigning the specified spring. If it is False, the specified spring is added to any existing springs already assigned to the frame object.</p>
<p class="ParameterName">CSys</p>
<p class="Comment">This is Local (meaning the frame object local coordinate system) or the name of a defined coordinate system. This item is the coordinate system in which the user specified direction vector, Vec, is specified. This item applies only when SpringLocalOneType = 3.</p>
<p class="ParameterName">ItemType</p>
<p class="Comment">This is one of the following items in the eItemType enumeration:</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">Object = 0</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">Group = 1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">SelectedObjects = 2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">If this item is Object, the assignment is made to the frame object specified by the Name item.</p>
<p class="Comment">If this item is Group, the assignment is made to all frame objects in the group specified by the Name item.</p>
<p class="Comment">If this item is SelectedObjects, assignment is made to all selected frame objects, and the Name item is ignored.</p>
<h2>Remarks</h2>
<p class="Comment">This function makes spring assignments to frame objects.</p>
<p class="Comment">The function returns zero if the assignments are successfully applied, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub AssignFrameSprings()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Vec() As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)<br>
<br>
&#160;&#160;&#160;'assign springs to frame<br>
&#160;&#160;&#160;&#160;&#160;&#160;ReDim Vec(2)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.FrameObj.SetSpring("ALL", 1, 1, 1, "", 1, 2, 0, Vec, 0, False, "Local", Group)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetSpring_{Frame_Object}.htm">GetSpring</a></p>
<p class="Block-Text"><a href="DeleteSpring_{Frame_Object}.htm">DeleteSpring</a></p>
</body>
</html>
