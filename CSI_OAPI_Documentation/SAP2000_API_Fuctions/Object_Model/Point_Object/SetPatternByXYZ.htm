
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Point Object Functions\SetPatternByXYZ.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetPatternByXYZ</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>SetPatternByXYZ</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.Sap2000.PointObj.SetPatternByXYZ</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetPatternByXYZ(ByVal Name As String, ByVal PatternName As String, ByVal a As Double, ByVal b As Double, ByVal c As Double, ByVal d As Double, Optional ByVal ItemType As eItemType = object, Optional ByVal Restriction As Long = 0, Optional ByVal Replace As Boolean = False) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing point object or group depending on the value of the ItemType item.</p>
<p class="ParameterName">PatternName</p>
<p class="Comment">The name of a defined joint pattern.</p>
<p class="ParameterName">a</p>
<p class="Comment">The value a in the equation shown in the Remarks section. [1/L]</p>
<p class="ParameterName">b</p>
<p class="Comment">The value b in the equation shown in the Remarks section. [1/L]</p>
<p class="ParameterName">c</p>
<p class="Comment">The value c in the equation shown in the Remarks section. [1/L]</p>
<p class="ParameterName">d</p>
<p class="Comment">The value d in the equation shown in the Remarks section. This item is unitless.</p>
<p class="ParameterName">ItemType</p>
<p class="Comment">This is one of the following items in the eItemType enumeration:</p>
<p class="Block-Text" style="margin-left: 85px;">Object = 0</p>
<p class="Block-Text" style="margin-left: 85px;">Group = 1</p>
<p class="Block-Text" style="margin-left: 85px;">SelectedObjects = 2</p>
<p class="Comment">&#160;</p>
<p class="Comment">If this item is Object, the joint pattern assignment is made to the point object specified by the Name item.</p>
<p class="Comment">If this item is Group, the joint pattern assignment is made to all point objects in the group specified by the Name item.</p>
<p class="Comment">If this item is SelectedObjects, the joint pattern assignment is made to all selected point objects and the Name item is ignored.</p>
<p class="ParameterName">Restriction</p>
<p class="Comment">This is either 0, 1, or 2.</p>
<p class="Block-Text" style="margin-left: 85px;">0 = All values are used</p>
<p class="Block-Text" style="margin-left: 85px;">1 = Negative values are set to zero</p>
<p class="Block-Text" style="margin-left: 85px; margin-bottom: 9pt;">2 = Positive values are set to zero</p>
<p class="ParameterName">Replace</p>
<p class="Comment">If this item is True, the joint pattern value calculated as shown in the Remarks section replaces any previous joint pattern value for the point object.</p>
<p class="Comment">If this item is False, the joint pattern value calculated as shown in the Remarks section is added to any previous joint pattern value for the point object and then the Restriction items are checked.</p>
<h2>Remarks</h2>
<p class="Comment">This function sets the joint pattern value for a specified point object and joint pattern.</p>
<p class="Comment">The joint pattern value is calculated as:</p>
<p class="Comment" style="margin-left: 88px;">Value = ax + by + cz + d</p>
<p class="Comment">where a, b, c and d are function input parameters and x, y and z are the coordinates of the considered point object in the present coordinate system</p>
<p class="Comment">The function returns zero if the pattern value is successfully assigned, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub SetJointPatternByXYZ()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)<br>
<br>
&#160;&#160;&#160;'add joint pattern assignment<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PointObj.SetPatternByXYZ("ALL", "Default", 0, 0, 10, 0, Group)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetPatternValue_{Point_Object}.htm">GetPatternValue</a></p>
<p class="Block-Text"><a href="SetPatternByPressure.htm">SetPatternByPressure</a></p>
<p class="Block-Text"><a href="DeletePatternValue.htm">DeletePatternValue</a></p>
<p class="Block-Text"><a href="../../General_Functions/GetPresentCoordSystem.htm">GetPresentCoordSystem</a></p>
<p class="Block-Text"><a href="../../General_Functions/SetPresentCoordSystem.htm">SetPresentCoordSystem</a></p>
</body>
</html>
