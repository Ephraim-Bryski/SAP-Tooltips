
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Solid Object Functions\SetSpring.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetSpring {Solid Object}</title>
<link rel="stylesheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>SetSpring</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.SolidObj.SetSpring</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetSpring(ByVal Name As String, ByVal MyType As Long, ByVal s As Double, ByVal SimpleSpringType As Long, ByVal LinkProp As String, ByVal Face as Long, ByVal SpringLocalOneType As Long, ByVal Dir As Long, ByVal Outward As Boolean, ByRef Vec() As Double, ByVal Ang As Double, ByVal Replace As Boolean, Optional ByVal CSys As String = "Local", Optional ByVal ItemType As eItemType = Object) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing solid object or group, depending on the value of the ItemType item.</p>
<p class="ParameterName">MyType</p>
<p class="Comment">This is either 1 or 2, indicating the spring property type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Simple spring</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Link property</p>
<p class="ParameterName">s</p>
<p class="Comment">The simple spring stiffness per unit area of the specified solid object face. This item applies only when MyType = 1. [F/L<sup style="font-size: 8pt;">3</sup>]</p>
<p class="ParameterName">SimpleSpringType</p>
<p class="Comment">This is 1, 2 or 3, indicating the simple spring type. This item applies only when MyType = 1.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Spring resists tension and compression</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Spring resists compression only</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = Spring resists tension only</p>
<p class="ParameterName">LinkProp</p>
<p class="Comment">The name of the link property assigned to the spring. This item applies only when MyType = 2.</p>
<p class="ParameterName">Face</p>
<p class="Comment">This is 1, 2, 3, 4, 5 or 6, indicating the solid object face to which the specified spring assignment applies.</p>
<p class="ParameterName">SpringLocalOneType</p>
<p class="Comment">This is 1, 2 or 3, indicating the method used to specify the spring positive local 1-axis orientation.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Parallel to solid object local axis</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Normal to specified solid object face</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = User specified direction vector</p>
<p class="ParameterName">Dir</p>
<p class="Comment">This is 1, 2, 3, -1, -2 or -3, indicating the solid object local axis that corresponds to the positive local 1-axis of the spring. This item applies only when SpringLocalOneType = 1.</p>
<p class="ParameterName">Outward</p>
<p class="Comment">This item is True if the spring positive local 1 axis is outward from the specified solid object face. This item applies only when SpringLocalOneType = 2.</p>
<p class="ParameterName">Vec</p>
<p class="Comment">This is an array of three values that define the direction vector of the spring positive local 1-axis. The direction vector is in the coordinate system specified by the CSys item. This item applies only when SpringLocalOneType = 3.</p>
<p class="ParameterName">Ang</p>
<p class="Comment">This is the angle that the link local 2-axis is rotated from its default orientation. This item applies only when MyType = 2. [deg]</p>
<p class="ParameterName">Replace</p>
<p class="Comment">If this item is True, all existing spring assignments to the solid object are removed before assigning the specified spring. If it is False, the specified spring is added to any existing springs already assigned to the solid object.</p>
<p class="ParameterName">CSys</p>
<p class="Comment">This is Local (meaning the solid object local coordinate system) or the name of a defined coordinate system. This item is the coordinate system in which the user specified direction vector, Vec, is specified. This item applies only when SpringLocalOneType = 3.</p>
<p class="ParameterName">ItemType</p>
<p class="Comment">This is one of the following items in the eItemType enumeration:</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">Object = 0</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">Group = 1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">SelectedObjects = 2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">If this item is Object, the assignment is made to the solid object specified by the Name item.</p>
<p class="Comment">If this item is Group, the assignment is made to all solid objects in the group specified by the Name item.</p>
<p class="Comment">If this item is SelectedObjects, assignment is made to all selected solid objects, and the Name item is ignored.</p>
<h2>Remarks</h2>
<p class="Comment">This function makes spring assignments to solid objects. The springs are assigned to a specified solid object face.</p>
<p class="Comment">The function returns zero if the assignments are successfully applied; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub AssignSolidObjectSprings()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Vec() As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)<br>
<br>
&#160;&#160;&#160;'assign springs to solid objects<br>
&#160;&#160;&#160;&#160;&#160;&#160;ReDim Vec(2)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.SolidObj.SetSpring("1", 1, 1, 1, "", 1, 1, 3, True, Vec, 0, False, "Local")<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetSpring_{Solid_Object}.htm">GetSpring</a></p>
<p class="Block-Text"><a href="DeleteSpring_{Solid_Object}.htm">DeleteSpring</a></p>
</body>
</html>
