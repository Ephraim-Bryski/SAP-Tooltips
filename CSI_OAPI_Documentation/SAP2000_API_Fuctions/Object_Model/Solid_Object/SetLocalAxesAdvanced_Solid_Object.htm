
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="GetLocalAxesAdvanced Solid Object.doc">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetLocalAxesAdvanced Solid Object</title>
<link rel="stylesheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>SetLocalAxesAdvanced</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.SolidObj.SetLocalAxesAdvanced</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetLocalAxesAdvanced(ByVal Name As String, ByVal Active As Boolean, ByVal AxVectOpt As Long, ByVal AxCSys As String, ByRef AxDir() As Long, ByRef AxPt() As String, ByRef AxVect() As Double, ByVal Plane2 As Long, ByVal PlVectOpt As Long, ByVal PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double, Optional ByVal ItemType As eItemType = Object) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing solid object or group, depending on the value of the ItemType item.</p>
<p class="ParameterName">Active</p>
<p class="Comment">This is True if advanced local axes exist.</p>
<p class="ParameterName">AxVectOpt, PlVectOpt</p>
<p class="Comment">This is 1, 2, or 3, indicating the axis/plane reference vector option. This item applies only when the Active item is True.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Coordinate direction</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Two joints</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = User vector</p>
<p class="ParameterName">AxCSys, PlCSys</p>
<p class="Comment">The coordinate system used to define the axis/plane reference vector coordinate directions and the axis/plane user vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1 or 3.</p>
<p class="ParameterName">AxDir, PlDir</p>
<p class="Comment">This is an array dimensioned to 1 (2 integers) indicating the axis/plane reference vector primary and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center in the specified coordinate system and used to determine the plane reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate direction values are:</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = +X&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-1 = -X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = +Y&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-2 = -Y</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = +Z&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-3 = -Z</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = +CR&#160;&#160;&#160;&#160;&#160;-4 = -CR</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = +CA&#160;&#160;&#160;&#160;&#160;-5 = -CA</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">6 = +CZ&#160;&#160;&#160;&#160;&#160;-6 = -CZ</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">7 = +SR&#160;&#160;&#160;&#160;&#160;-7 = -SR</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">8 = +SA&#160;&#160;&#160;&#160;&#160;-8 = -SA</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">9 = +SB&#160;&#160;&#160;&#160;&#160;-9 = -SB</p>
<p class="ParameterName">AxPt, PlPt</p>
<p class="Comment">This is an array dimensioned to 1 (2 strings) indicating the labels of two joints that define the axis/plane reference vector. Either of these joints may be specified as None to indicate the center of the specified object.&#160;&#160;If both joints are specified as None, they are not used to define the plane reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 2.</p>
<p class="ParameterName">AxVect, PlVect</p>
<p class="Comment">This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.</p>
<p class="ParameterName">Plane2</p>
<p class="Comment">This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference vector is the 1-2, 1-3, 2-1, 2-3, 3-1, or 3-2 plane. This item applies only when the Active item is True.</p>
<p class="ParameterName">ItemType</p>
<p class="Comment">This is one of the following items in the eItemType enumeration:</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">Object = 0</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">Group = 1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">Selection = 2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">If this item is Object, the assignment is made to the solid object specified by the Name item.</p>
<p class="Comment">If this item is Group, the assignment is made to all solid objects in the group specified by the Name item.</p>
<p class="Comment">If this item is Selection, assignment is made to all selected solid objects and the Name item is ignored.</p>
<h2>Remarks</h2>
<p class="Comment">This function assigns advanced local axes to solid objects.</p>
<p class="Comment">The function returns zero if the advanced local axes assignments are assigned successfully; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub AssignSolidAdvancedLocalAxes()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyAxDir(1) As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyAxPt(1) As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyAxVect(2) As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyPlDir(1) As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyPlPt(1) As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyPlVect(2) As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.NewSolidBlock(300, 400, 200, , , 2, 2, 2)<br>
<br>
&#160;&#160;&#160;'assign solid advanced local axes<br>
&#160;&#160;&#160;&#160;&#160;&#160;MyAxVect(0)=0.707<br>
&#160;&#160;&#160;&#160;&#160;&#160;MyAxVect(1)=0.707<br>
&#160;&#160;&#160;&#160;&#160;&#160;MyAxVect(2)=0<br>
&#160;&#160;&#160;&#160;&#160;&#160;MyPlDir(0) = 2<br>
&#160;&#160;&#160;&#160;&#160;&#160;MyPlDir(1) = 3<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.SolidObj.SetLocalAxesAdvanced("ALL", True, 3, "Global", MyAxDir, MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect, Group)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 14.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetLocalAxesAdvanced_Solid_Object.htm">GetLocalAxesAdvanced</a></p>
<p class="Block-Text"><a href="GetLocalAxes_{Solid_Object}.htm">GetLocalAxes</a></p>
</body>
</html>
