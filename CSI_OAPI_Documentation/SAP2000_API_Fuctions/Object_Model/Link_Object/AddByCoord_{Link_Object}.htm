
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Link Object Functions\AddByCoord.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>AddByCoord {Link Object}</title>
<link rel="stylesheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>AddByCoord</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LinkObj.AddByCoord</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function AddByCoord(ByVal xi As Double, ByVal yi As Double, ByVal zi As Double, ByVal xj As Double, ByVal yj As Double, ByVal zj As Double, ByRef Name As String, Optional IsSingleJoint As Boolean = False, Optional ByVal PropName As String = "Default", Optional ByVal UserName As String = "", Optional ByVal CSys As String = "Global") As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">xi, yi, zi</p>
<p class="Comment">The coordinates of the I-End of the added link object. The coordinates are in the coordinate system defined by the CSys item.</p>
<p class="ParameterName">xj, yj, zj</p>
<p class="Comment">The coordinates of the J-End of the added link object. The coordinates are in the coordinate system defined by the CSys item.</p>
<p class="Comment">These coordinates are ignored if the IsSingleJoint item is True.</p>
<p class="ParameterName">Name</p>
<p class="Comment">This is the name that the program ultimately assigns for the link object. If no UserName is specified, the program assigns a default name to the link object. If a UserName is specified and that name is not used for another link object, the UserName is assigned to the link object; otherwise a default name is assigned to the link object.</p>
<p class="ParameterName">IsSingleJoint</p>
<p class="Comment">This item is True if a one-joint link is added and False if a two-joint link is added.</p>
<p class="ParameterName">PropName</p>
<p class="Comment">This is either Default or the name of a defined link property.</p>
<p class="Comment">If it is Default the program assigns a default link property to the link object. If it is the name of a defined link property, that property is assigned to the link object.</p>
<p class="ParameterName">UserName</p>
<p class="Comment">This is an optional user specified name for the link object. If a UserName is specified and that name is already used for another link object, the program ignores the UserName.</p>
<p class="ParameterName">CSys</p>
<p class="Comment">The name of the coordinate system in which the link object end point coordinates are defined.</p>
<h2>Remarks</h2>
<p class="Comment">This function adds a new link object whose end points are at the specified coordinates.</p>
<p class="Comment">The function returns zero if the link object is successfully added; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub AddLinkObjByCoord()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Name1 As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Name2 As String<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = New Sap200015.SapObject<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)<br>
<br>
&#160;&#160;&#160;'add link object by coordinates<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LinkObj.AddByCoord(-288, 0, 288, 0, 0, 0, Name1, True)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LinkObj.AddByCoord(-288, 0, 0, 0, 0, 144, Name2)<br>
<br>
&#160;&#160;&#160;'refresh view<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.View.RefreshView<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<h2>See Also</h2>
<p class="Comment"><a href="AddByPoint_{Link_Object}.htm">AddByPoint</a></p>
</body>
</html>
