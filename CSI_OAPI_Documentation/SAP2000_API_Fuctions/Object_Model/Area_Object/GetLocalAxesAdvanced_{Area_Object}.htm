
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="SetLocalAxesAdvanced (Area Object).doc">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetLocalAxesAdvanced {Area Object}</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>GetLocalAxesAdvanced</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.AreaObj.GetLocalAxesAdvanced</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetLocalAxesAdvanced(ByVal Name As String, ByRef Active As Boolean, ByRef Plane2 As Long, ByRef PlVectOpt As Long, ByRef PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing area object.</p>
<p class="ParameterName">Active</p>
<p class="Comment">This is True if advanced local axes exist.</p>
<p class="ParameterName">Plane2</p>
<p class="Comment">This is 31 or 32, indicating that the local plane determined by the plane reference vector is the 3-1 plane or the 3-2 plane. This item applies only when the Active item is True.</p>
<p class="ParameterName">PlVectOpt</p>
<p class="Comment">This is 1, 2, or 3, indicating the plane reference vector option. This item applies only when the Active item is True.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Coordinate direction</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Two joints</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = User vector</p>
<p class="ParameterName">PlCSys</p>
<p class="Comment">The coordinate system used to define the plane reference vector coordinate directions and the plane user vector. This item applies when the Active item is True and the PlVectOpt item is 1 or 3.</p>
<p class="ParameterName">PlDir</p>
<p class="Comment">This is an array dimensioned to 1 (2 integers) indicating the plane reference vector primary and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center in the specified coordinate system and used to determine the plane reference vector. This item applies when the Active item is True and the PlVectOpt item is 1. Possible coordinate direction values are:</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = +X&#160;&#160;&#160;&#160;&#160;&#160;-1 = -X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = +Y&#160;&#160;&#160;&#160;&#160;&#160;-2 = -Y</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = +Z&#160;&#160;&#160;&#160;&#160;&#160;-3 = -Z</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = +CR&#160;&#160;&#160;&#160;&#160;-4 = -CR</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = +CA&#160;&#160;&#160;&#160;&#160;-5 = -CA</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">6 = +CZ&#160;&#160;&#160;&#160;&#160;-6 = -CZ</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">7 = +SR&#160;&#160;&#160;&#160;&#160;-7 = -SR</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">8 = +SA&#160;&#160;&#160;&#160;&#160;-8 = -SA</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">9 = +SB&#160;&#160;&#160;&#160;&#160;-9 = -SB</p>
<p class="ParameterName">PlPt</p>
<p class="Comment">This is an array dimensioned to 1 (2 strings) indicating the labels of two joints that define the plane reference vector. Either of these joints may be specified as None to indicate the center of the specified object.&#160;&#160;If both joints are specified as None, they are not used to define the plane reference vector. This item applies when the Active item is True and the PlVectOpt item is 2.</p>
<p class="ParameterName">PlVect</p>
<p class="Comment">This is an array dimensioned to 2 (3 doubles) that defines the plane reference vector. This item applies when the Active item is True and the PlVectOpt item is 3.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves the advanced local axes assignments to area objects.</p>
<p class="Comment">The function returns zero if the advanced local axes assignments are &#160;retrieved successfully; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetAreaAdvancedLocalAxes()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyPlDir(1) As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyPlPt(1) As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyPlVect(2) As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Ang As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Advanced As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Active As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Plane2 As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PlVectOpt As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PlCSys As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PlDir() As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PlPt() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PlVect() As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.NewWall(2, 48, 2, 48)<br>
<br>
&#160;&#160;&#160;'assign area advanced local axes<br>
&#160;&#160;&#160;&#160;&#160;&#160;MyPlDir(0) = 2<br>
&#160;&#160;&#160;&#160;&#160;&#160;MyPlDir(1) = 3<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.AreaObj.SetLocalAxesAdvanced("3", True, 31, 1, "Global", MyPlDir, MyPlPt, MyPlVect)<br>
<br>
&#160;&#160;&#160;'get area object local axis angle<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.AreaObj.GetLocalAxes("3", Ang, Advanced)<br>
<br>
&#160;&#160;&#160;'get area advanced local axes data<br>
&#160;&#160;&#160;&#160;&#160;&#160;If Advanced Then<br>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.AreaObj.GetLocalAxesAdvanced("3", Active, Plane2, PlVectOpt, PlCSys, PlDir, PlPt, PlVect)<br>
&#160;&#160;&#160;&#160;&#160;&#160;End If<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 14.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetLocalAxesAdvanced.htm">SetLocalAxesAdvanced</a></p>
<p class="Block-Text"><a href="SetLocalAxes_{Area_Object}.htm">SetLocalAxes</a></p>
<p class="Block-Text"><a href="GetLocalAxes_{Area_Object}.htm">GetLocalAxes</a></p>
</body>
</html>
