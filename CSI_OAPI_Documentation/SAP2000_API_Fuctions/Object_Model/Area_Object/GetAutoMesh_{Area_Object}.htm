
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Area Object Functions\GetAutoMesh.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetAutoMesh {Area Object}</title>
<link rel="stylesheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>GetAutoMesh</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.AreaObj.GetAutoMesh</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetAutoMesh(ByVal Name As String, ByRef MeshType As Long, ByRef n1 As Long, ByRef n2 As Long, ByRef MaxSize1 As Double, ByRef MaxSize2 As Double, ByRef PointOnEdgeFromLine As Boolean, ByRef PointOnEdgeFromPoint As Boolean, ByRef ExtendCookieCutLines As Boolean, ByRef Rotation As Double, ByRef MaxSizeGeneral As Double, ByRef LocalAxesOnEdge As Boolean, ByRef LocalAxesOnFace As Boolean, ByRef RestraintsOnEdge As Boolean, ByRef RestraintsOnFace As Boolean, ByRef Group As String, ByRef SubMesh As Boolean, ByRef SubMeshSize As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing area object.</p>
<p class="ParameterName">MeshType</p>
<p class="Comment">This item is 0, 1, 2, 3, 4, 5 or 6, indicating the automatic mesh type for the area object.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">0 = No automatic meshing</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Mesh area into a specified number of objects</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Mesh area into objects of a specified maximum size</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = Mesh area based on points on area edges</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = Cookie cut mesh area based on lines intersecting edges</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = Cookie cut mesh area based on points</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">6 = Mesh area using General Divide Tool</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">Mesh options 1, 2 and 3 apply to quadrilaterals and triangles only.</p>
<p class="ParameterName">n1</p>
<p class="Comment">This item applies when MeshType = 1. It is the number of objects created along the edge of the meshed area object that runs from point 1 to point 2.</p>
<p class="ParameterName">n2</p>
<p class="Comment">This item applies when MeshType = 1. It is the number of objects created along the edge of the meshed area object that runs from point 1 to point 3.</p>
<p class="ParameterName">MaxSize1</p>
<p class="Comment">This item applies when MeshType = 2. It is the maximum size of objects created along the edge of the meshed area object that runs from point 1 to point 2. [L]</p>
<p class="ParameterName">MaxSize2</p>
<p class="Comment">This item applies when MeshType = 2. It is the maximum size of objects created along the edge of the meshed area object that runs from point 1 to point 3. [L]</p>
<p class="ParameterName">PointOnEdgeFromLine</p>
<p class="Comment">This item applies when MeshType = 3. If it is True, points on the area object edges are determined from intersections of straight line objects included in the group specified by the Group item with the area object edges.</p>
<p class="ParameterName">PointOnEdgeFromPoint</p>
<p class="Comment">This item applies when MeshType = 3. If it is True, points on the area object edges are determined from point objects included in the group specified by the Group item that lie on the area object edges.</p>
<p class="ParameterName">ExtendCookieCutLines</p>
<p class="Comment">This item applies when MeshType = 4. MeshType = 4 provides cookie cut meshing based on straight line objects included in the group specified by the Group item that intersect the area object edges. If the ExtendCookieCutLines item is True, all straight line objects included in the group specified by the Group item are extended to intersect the area object edges for the purpose of meshing the area object.</p>
<p class="ParameterName">Rotation</p>
<p class="Comment">This item applies when MeshType = 5. MeshType = 5 provides cookie cut meshing based on two perpendicular lines passing through point objects included in the group specified by the Group item. By default these lines align with the area object local 1 and 2 axes. The Rotation item is an angle in degrees that the meshing lines are rotated from their default orientation. [deg]</p>
<p class="ParameterName">MaxSizeGeneral</p>
<p class="Comment">This item applies when MeshType = 6. It is the maximum size of objects created by the General Divide Tool.</p>
<p class="ParameterName">LocalAxesOnEdge</p>
<p class="Comment">If this item is True, and if both points along an edge of the original area object have the same local axes, the program makes the local axes for added points along the edge the same as the edge end points.</p>
<p class="ParameterName">LocalAxesOnFace</p>
<p class="Comment">If this item is True, and if all points around the perimeter of the original area object have the same local axes, the program makes the local axes for all added points the same as the perimeter points.</p>
<p class="ParameterName">RestraintsOnEdge</p>
<p class="Comment">If this item is True, and if both points along an edge of the original area object have the same restraint/constraint, then, if the added point and the adjacent corner points have the same local axes definition, the program includes the restraint/constraint for added points along the edge.</p>
<p class="ParameterName">RestraintsOnFace</p>
<p class="Comment">If this item is True, and if all points around the perimeter of the original area object have the same restraint/constraint, then, if an added point and the perimeter points have the same local axes definition, the program includes the restraint/constraint for the added point.</p>
<p class="ParameterName">Group</p>
<p class="Comment">The name of a defined group. Some of the meshing options make use of point and line objects included in this group.</p>
<p class="ParameterName">SubMesh</p>
<p class="Comment">If this item is True, after initial meshing, the program further meshes any area objects that have an edge longer than the length specified by the SubMeshSize item.</p>
<p class="ParameterName">SubMeshSize</p>
<p class="Comment">This item applies when the SubMesh item is True. It is the maximum size of area objects to remain when the auto meshing is complete. [L]</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves the automatic meshing assignments to area objects.</p>
<p class="Comment">The function returns zero if the meshing assignments are successfully retrieved, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetAreaObjAutoMesh()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MeshType As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim n1 As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim n2 As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MaxSize1 As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MaxSize2 As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PointOnEdgeFromLine As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PointOnEdgeFromPoint As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ExtendCookieCutLines As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Rotation As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MaxSizeGeneral As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LocalAxesOnEdge As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LocalAxesOnFace As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim RestraintsOnEdge As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim RestraintsOnFace As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim MyGroup As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SubMesh As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SubMeshSize As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.NewWall(2, 48, 2, 48)<br>
<br>
&#160;&#160;&#160;'assign auto mesh options<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.AreaObj.SetAutoMesh("ALL", 1, 3, 3, , , , , , , , , , , , , True, , Group)<br>
<br>
&#160;&#160;&#160;'get auto mesh options for area object<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.AreaObj.GetAutoMesh("1", MeshType, n1, n2, MaxSize1, MaxSize2, PointOnEdgeFromLine, PointOnEdgeFromPoint, ExtendCookieCutLines, Rotation, MaxSizeGeneral, LocalAxesOnEdge, LocalAxesOnFace, RestraintsOnEdge, RestraintsOnFace, MyGroup, SubMesh, SubMeshSize)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<h2>See Also</h2>
<p class="Comment"><a href="SetAutoMesh_{Area_Object}.htm">SetAutoMesh</a></p>
</body>
</html>
