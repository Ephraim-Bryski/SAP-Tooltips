
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="GetAS11702007.doc">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetEurocode82004 (Auto Seismic)</title>
<link rel="StyleSheet" href="../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../ehlpdhtm.js"></script>

<h1>GetEurocode82004 &#160;<span style="font-size: 10pt;">(Note: &#160;Newer function available)</span></h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadPatterns.AutoSeismic.GetEurocode82004</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetEurocode82004(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double, ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef EURO2004GroundType As Long, ByRef EURO2004SpectrumType As Long, ByRef EURO2004ag As Double, ByRef EURO2004Beta As Double, ByRef EURO2004q As Double, ByRef EURO2004Lambda As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing Quake-type load pattern with a Eurocode 8 2004 auto seismic load assignment.</p>
<p class="ParameterName">DirFlag</p>
<p class="Comment">This is 1 or 2, indicating the seismic load direction.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Global X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Global Y</p>
<p class="ParameterName">Eccen</p>
<p class="Comment">The eccentricity ratio that applies to all diaphragms.</p>
<p class="ParameterName">PeriodFlag</p>
<p class="Comment">This is 1, 2 or 3, indicating the time period option.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Approximate</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Program calculated</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = User defined</p>
<p class="ParameterName">CT</p>
<p class="Comment">The code-specified Ct factor. This item applies when the PeriodFlag item is 1.</p>
<p class="ParameterName">UserT</p>
<p class="Comment">The user specified time period. This item applies when the PeriodFlag item is 3. [s]</p>
<p class="ParameterName">UserZ</p>
<p class="Comment">This item is True if the top and bottom elevations of the seismic load are user specified. It is False if the elevations are determined by the program.</p>
<p class="ParameterName">TopZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">BottomZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">EURO2004GroundType</p>
<p class="Comment">This is 1, 2, 3, 4 or 5, indicating the ground type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = D</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">5 = E</p>
<p class="ParameterName">EURO2004SpectrumType</p>
<p class="Comment">This is 1 or 2, indicating the spectrum type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Type 1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Type 2</p>
<p class="ParameterName">EURO2004ag</p>
<p class="Comment">The design ground acceleration in g, ag.</p>
<p class="ParameterName">EURO2004Beta</p>
<p class="Comment">The lower bound factor, Beta.</p>
<p class="ParameterName">EURO2004q</p>
<p class="Comment">The behavior factor, q.</p>
<p class="ParameterName">EURO2004Lambda</p>
<p class="Comment">The correction factor, Lambda.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves auto seismic loading parameters for the Eurocode 8 2004 code.</p>
<p class="Comment">The function returns zero if the parameters are successfully retrieved; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetSeismicParametersEurocode82004()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject As Sap2000v15.SapObject<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim DirFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Eccen As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PeriodFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim CT As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UserT As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UserZ As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim TopZ As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim BottomZ As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim EURO2004GroundType As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim EURO2004SpectrumType As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim EURO2004ag As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim EURO2004Beta As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim EURO2004q As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim EURO2004Lambda As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = New Sap2000v15.SapObject<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)<br>
<br>
&#160;&#160;&#160;'add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)<br>
<br>
&#160;&#160;&#160;'assign Eurocode 8 2004 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.SetEurocode82004("EQX", 2, 0.1, 2, 0.075, 0, False, 0, 0, 2, 1, 0.4, 0.2, 2, 1)<br>
<br>
&#160;&#160;&#160;'get Eurocode 8 2004 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.GetEurocode82004("EQX", DirFlag, Eccen, PeriodFlag, CT, UserT, UserZ, TopZ, BottomZ, EURO2004GroundType, EURO2004SpectrumType, EURO2004ag, EURO2004Beta, EURO2004q, EURO2004Lambda)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 14.00.</p>
<p class="Comment">The function is obsolete and has been superseded by <a href="../Definitions/Load_Pattern/Auto_Seismic_Load/GetEurocode82004_1_{Auto_Seismic}.htm">GetEurocode82004_1</a> as of version 14.1.0. This function is maintained for backward compatibility. New function added.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetEurocode82004_(Auto_Seismic).htm">SetEurocode82004</a></p>
</body>
</html>
