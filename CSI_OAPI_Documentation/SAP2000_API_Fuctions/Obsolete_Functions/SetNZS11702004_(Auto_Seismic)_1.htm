
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetNZS11702004 (Auto Seismic)_1</title>
<link rel="StyleSheet" href="../../SAP2000.CSS" type="text/css">
</head>

<body>
<script type="text/javascript" src="../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>SetNZS11702004_1&#160;<span style="font-size: 10pt;">(Note: Newer function 
 available)</span></h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadPatterns.AutoSeismic.SetNZS11702004_1</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetNZS11702004_1(ByVal Name As String, ByVal 
 DirFlag As Long, ByVal Eccen As Double, ByVal PeriodFlag As Long, ByVal 
 UserT As Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ 
 As Double, ByVal NZS2004SiteClass As Long, ByVal NZS2004Z As Double, ByVal 
 NZS2004R As Double, ByVal NZS2004DIST As Double, ByVal NZS2004Sp As Double, 
 ByVal NZS2004Mu As Double, ByValNZS2004ConsiderTSite As Boolean, ByValNZS2004TSite 
 As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing Quake-type load pattern.</p>
<p class="ParameterName">DirFlag</p>
<p class="Comment">This is 1 or 2, indicating the seismic load direction.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-bottom: .0001pt; margin-left: 88px;">1 = Global X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-left: 88px; margin-bottom: 9pt;">2 = Global Y</p>
<p class="ParameterName">Eccen</p>
<p class="Comment">The eccentricity ratio that applies to all diaphragms.</p>
<p class="ParameterName">PeriodFlag</p>
<p class="Comment">This is 1, 2 or 3, indicating the time period option.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-bottom: .0001pt; margin-left: 88px;">1 = Approximate</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-bottom: .0001pt; margin-left: 88px;">2 = Program calculated</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-left: 88px; margin-bottom: 9pt;">3 = User defined</p>
<p class="ParameterName">UserT</p>
<p class="Comment">The user specified time period. This item applies when 
 the PeriodFlag item is 3. [s]</p>
<p class="ParameterName">UserZ</p>
<p class="Comment">This item is True if the top and bottom elevations of 
 the seismic load are user specified. It is False if the elevations are 
 determined by the program.</p>
<p class="ParameterName">TopZ</p>
<p class="Comment">This item applies only when the UserZ item is True. 
 It is the global Z-coordinate at the highest level where auto seismic 
 loads are applied. [L]</p>
<p class="ParameterName">BottomZ</p>
<p class="Comment">This item applies only when the UserZ item is True. 
 It is the global Z-coordinate at the lowest level where auto seismic loads 
 are applied. [L]</p>
<p class="ParameterName">NZS2004SiteClass</p>
<p class="Comment">This is 1, 2, 3, 4 or 5, indicating the site class.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-bottom: .0001pt; margin-left: 88px;">4 = D</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; 
	 margin-left: 88px; margin-bottom: 9pt;">5 = E</p>
<p class="ParameterName">NZS2004Z</p>
<p class="Comment">The hazard factor, Z.</p>
<p class="ParameterName">NZS2004R</p>
<p class="Comment">The return period factor, R.</p>
<p class="ParameterName">NZS2004DIST</p>
<p class="Comment">Distance to the fault in km, used to calculate the near 
 fault factor.</p>
<p class="ParameterName">NZS2004Sp</p>
<p class="Comment">The structural performance factor, Sp.</p>
<p class="ParameterName">NZS2004Mu</p>
<p class="Comment">The structural ductility factor, u.</p>
<p class="ParameterName">NZS2004ConsiderTSite</p>
<p class="Comment">Indicates whether to consider the site period for the 
 spectral shape factor.</p>
<p class="ParameterName">NZS2004TSite</p>
<p class="Comment">The low amplitude site period.</p>
<h2>Remarks</h2>
<p class="Comment">This function assigns auto seismic loading parameters 
 for the NZS 1170.5 2004 code.</p>
<p class="Comment">The function returns zero if the parameters are successfully 
 assigned; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub AssignSeismicNZS11702004_1()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject(&quot;CSI.SAP2000.API.SapObject&quot;)<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New3DFrame(BeamSlab, 
 2, 144, 3, 336, 2, 432)<br>
<br>
&#160;&#160;&#160;'add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add(&quot;EQX&quot;, 
 LTYPE_QUAKE)<br>
<br>
&#160;&#160;&#160;'assign NZS 1170 2004 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.SetNZS11702004_1(&quot;EQX&quot;, 
 2, 0.1, 2, 0, False, 0, 0, 3, 0.4, 1.3, 20, 0.7, 3, True, 1)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in v21.0.0.</p>
<p class="Comment">This function supersedes <a href="SetNZS11702004_(Auto_Seismic).htm">SetNZS11702004</a>.</p>
<p class="Comment">This function is obsolete and has been superseded by 
 SetNZS11702004_2 as of v22.0.0. This function is maintained for backward 
 compatibility. &#160;</p>
<p class="Comment">&#160;</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetNZS11702004_(Auto_Seismic)_1.htm">GetNZS11702004_1</a></p>
</body>
</html>
