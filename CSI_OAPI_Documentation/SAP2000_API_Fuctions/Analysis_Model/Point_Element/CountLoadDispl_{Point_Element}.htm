
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Point Element Functions\CountLoadDispl.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>CountLoadDispl {Point Element}</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>CountLoadDispl</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.PointElm.CountLoadDispl</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function CountLoadDispl(ByRef Count As Long, Optional ByVal Name As String = "", Optional ByVal LoadPat As String = "") As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Count</p>
<p class="Comment">The number of counted ground displacement loads.</p>
<p class="ParameterName">Name</p>
<p class="Comment">This optional item is the name of an existing point element.</p>
<p class="ParameterName">LoadPat</p>
<p class="Comment">This optional item is the name of an existing load pattern.</p>
<h2>Remarks</h2>
<p class="Comment">If neither the Name item nor the LoadPat item is provided, the Count item returns the total number of ground displacement load assignments to point elements in the model.</p>
<p class="Comment">If the Name item is provided but not the LoadPat item, the Count item returns the total number of ground displacement load assignments made for the specified point element.</p>
<p class="Comment">If the Name item is not provided but the LoadPat item is specified, the Count item returns the total number of ground displacement load assignments made to all point elements for the specified load pattern.</p>
<p class="Comment">If both the Name item and the LoadPat item are provided, the Count item returns the total number of ground displacement load assignments made to the specified point element for the specified load pattern.</p>
<p class="Comment">If the Name item or the LoadPat item is provided but is not recognized by the program as valid, an error is returned.</p>
<p class="Comment">This function returns zero if the count is successfully completed, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub CountGroundDisplacementElmLoads()<br>
&#160;&#160;&#160;'dimension variables<span style="color: #ff0000;"><br>
&#160;&#160;&#160;&#160;&#160;&#160;</span>Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Value() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Count As Long<span style="color: #ff0000;"><br>
<br>
&#160;&#160;&#160;</span>'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)<br>
<br>
&#160;&#160;&#160;'add ground displacement load<br>
&#160;&#160;&#160;&#160;&#160;&#160;Redim Value(5)<br>
&#160;&#160;&#160;&#160;&#160;&#160;Value(0) = 10<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PointObj.SetLoadDispl("1", "DEAD", Value)<br>
<br>
&#160;&#160;&#160;'create analysis model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.Analyze.CreateAnalysisModel<br>
<br>
&#160;&#160;&#160;'get number of ground displacement loads for point elements<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PointElm.CountLoadDispl(Count)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<p class="Comment">Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load Patterns, Load Cases and Load Combinations, respectively, in version 12.00.</p>
<h2>See Also</h2>
<p class="Comment"><a href="GetLoadDispl_{Point_Element}.htm">GetLoadDispl</a></p>
</body>
</html>
