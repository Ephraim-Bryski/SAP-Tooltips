
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Generalized Displacement Functions\GetPoint.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetPoint</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>GetPoint</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.GDispl.GetPoint</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetPoint(ByVal Name As String, ByRef NumberItems As Long, ByRef PointName() As String, ByRef U1() As Double, ByRef U2() As Double, ByRef U3() As Double, ByRef R1() As Double, ByRef R2() As Double, ByRef R3() As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing generalized displacement.</p>
<p class="ParameterName">NumberItems</p>
<p class="Comment">The number of point objects included in the generalized displacement definition.</p>
<p class="ParameterName">PointName</p>
<p class="Comment">This is an array that includes the name of the point objects included in the generalized displacement definition.</p>
<p class="ParameterName">U1, U2, U3, R1, R2, R3</p>
<p class="Comment">These are arrays that include the unitless scale factors for each of the displacement degrees of freedom of the associated point objects that are included in the generalized displacement definition.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves the point objects and their scale factors from a generalized displacement definition.</p>
<p class="Comment">The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetGDisplPointData()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NumberItems As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PointName() As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim U1() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim U2() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim U3() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim R1() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim R2() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim R3() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SF() As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)<br>
<br>
&#160;&#160;&#160;'add generalized displacement<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.GDispl.Add("GD1", 1)<br>
<br>
&#160;&#160;&#160;'add points to generalized displacement<br>
&#160;&#160;&#160;&#160;&#160;&#160;ReDim SF(5)<br>
&#160;&#160;&#160;&#160;&#160;&#160;SF(0) = 0.5<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.GDispl.SetPoint("GD1", "3", SF)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.GDispl.SetPoint("GD1", "7", SF)<br>
<br>
&#160;&#160;&#160;'get point data from generalized displacement<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.GDispl.GetPoint("GD1", NumberItems, PointName, U1, U2, U3, R1, R2, R3)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<h2>See Also</h2>
<p class="Comment"><a href="SetPoint.htm">SetPoint</a></p>
</body>
</html>
