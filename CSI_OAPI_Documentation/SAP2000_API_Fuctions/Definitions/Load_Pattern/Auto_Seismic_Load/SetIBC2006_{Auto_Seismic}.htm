
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Load Case Functions\Auto Seismic Load Functions\SetIBC2006.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetIBC2006 {Auto Seismic}</title>
<link rel="stylesheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../../ehlpdhtm.js"></script>

<h1>SetIBC2006</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadPatterns.AutoSeismic.SetIBC2006</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetIBC2006(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double, ByVal PeriodFlag As Long, ByVal IBC2006CtType As Long, ByVal UserT As Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal IBC2006R As Double, ByVal IBC2006Omega As Double, ByVal IBC2006Cd As Double, ByVal IBC2006I As Double, ByVal IBC2006Option As Long, ByVal IBC2006Latitude As Double, ByVal IBC2006Longitude As Double, ByVal IBC2006ZipCode As String, ByVal IBC2006SS As Double, ByVal IBC2006S1 As Double, ByVal IBC2006TL As Double, ByVal IBC2006SiteClass As Long, ByVal IBC2006Fa As Double, ByVal IBC2006Fv As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing Quake-type load pattern.</p>
<p class="ParameterName">DirFlag</p>
<p class="Comment">This is either 1 or 2, indicating the seismic load direction.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Global X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Global Y</p>
<p class="ParameterName">Eccen</p>
<p class="Comment">The eccentricity ratio that applies to all diaphragms.</p>
<p class="ParameterName">PeriodFlag</p>
<p class="Comment">This is 1, 2 or 3, indicating the time period option.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Approximate</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Program calculated</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: 9pt; margin-left: 88px;">3 = User defined</p>
<p class="ParameterName">IBC2006CtType</p>
<p class="Comment">This is 0, 1, 2 or 3, indicating the values of Ct and x. This item applies when the PeriodFlag item is 1 or 2.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">0 = Ct = 0.028 (ft),&#160;&#160;&#160;&#160;&#160;x = 0.8</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Ct = 0.016 (ft),&#160;&#160;&#160;&#160;&#160;x = 0.9</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Ct = 0.03 (ft),&#160;&#160;&#160;&#160;&#160;&#160;x = 0.75</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: 9pt; margin-left: 88px;">3 = Ct = 0.02 (ft),&#160;&#160;&#160;&#160;&#160;&#160;x = 0.75</p>
<p class="ParameterName">UserT</p>
<p class="Comment">The user specified time period. This item applies when the PeriodFlag item is 3. [s]</p>
<p class="ParameterName">UserZ</p>
<p class="Comment">This item is True if the top and bottom elevations of the seismic load are user specified. It is False if the elevations are determined by the program.</p>
<p class="ParameterName">TopZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">BottomZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">IBC2006R</p>
<p class="Comment">The response modification factor.</p>
<p class="ParameterName">IBC2006Omega</p>
<p class="Comment">The system overstrength factor.</p>
<p class="ParameterName">IBC2006Cd</p>
<p class="Comment">The deflection amplification factor.</p>
<p class="ParameterName">IBC2006I</p>
<p class="Comment">The occupancy importance factor.</p>
<p class="ParameterName">IBC2006Option</p>
<p class="Comment">This is 0, 1 or 2, indicating the seismic coefficient option.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">0 = Ss and S1 from USGS by latitude and longitude</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Ss and S1 from USGS by zip code</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Ss and S1 are user defined</p>
<p class="ParameterName">IBC2006Latitude, IBC2006Longitude</p>
<p class="Comment">The latitude and longitude for which the seismic coefficients are obtained. These items are used only when IBC2006Option = 0.</p>
<p class="ParameterName">IBC2006ZipCode</p>
<p class="Comment">The zip code for which the seismic coefficients are obtained. This item is used only when IBC2006Option = 1.</p>
<p class="ParameterName">IBC2006SS, IBC2006S1</p>
<p class="Comment">The seismic coefficients Ss and S1. This item is used only when IBC2006Option = 2.</p>
<p class="ParameterName">IBC2006TL</p>
<p class="Comment">The long-period transition period. [s]</p>
<p class="ParameterName">IBC2006SiteClass</p>
<p class="Comment">This is 1, 2, 3, 4, 5 or 6, indicating the site class.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = D</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = E</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">6 = F</p>
<p class="ParameterName">IBC2006Fa, IBC2006Fv</p>
<p class="Comment">The site coefficients Fa and Fv. These items are used only when IBC2006SiteClass= 6.</p>
<h2>Remarks</h2>
<p class="Comment">This function assigns auto seismic loading parameters for the 2006 IBC code.</p>
<p class="Comment">The function returns zero if the parameters are successfully assigned; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub AssignSeismicIBC2006()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)<br>
<br>
&#160;&#160;&#160;'add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)<br>
<br>
&#160;&#160;&#160;'assign IBC2006 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.SetIBC2006("EQX", 1, 0.05, 1, 1, 0, False, 0, 0, 8, 3, 5.5, 1, 1, 0, 0, "94704", 0, 0, 8, 3, 0, 0)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.01.</p>
<p class="Comment">Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load Patterns, Load Cases and Load Combinations, respectively, in version 12.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetIBC2006_{Auto_Seismic}.htm">GetIBC2006</a></p>
</body>
</html>
