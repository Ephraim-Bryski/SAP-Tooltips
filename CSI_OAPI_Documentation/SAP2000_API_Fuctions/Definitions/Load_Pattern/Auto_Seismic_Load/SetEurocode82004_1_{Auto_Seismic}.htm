
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="GetEurocode82004_1.doc">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetEurocode82004_1 {Auto Seismic}</title>
<link rel="StyleSheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../../ehlpdhtm.js"></script>

<h1>SetEurocode82004_1</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadPatterns.AutoSeismic.SetEurocode82004_1</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetEurocode82004_1(ByVal Name As String, ByVal DirFlag As Long, ByVal Eccen As Double, ByVal PeriodFlag As Long, ByVal CT As Double, ByVal UserT As Double, ByVal UserZ As Boolean, ByVal TopZ As Double, ByVal BottomZ As Double, ByVal EURO2004Country As Long, ByVal EURO2004SpectrumType As Long, ByVal EURO2004GroundType As Long, ByVal EURO2004ag As Double, ByVal EURO2004S As Double, ByVal EURO2004Tb As Double, ByVal EURO2004Tc As Double, ByVal EURO2004Td As Double, ByVal EURO2004Beta As Double, ByVal EURO2004q As Double, ByVal EURO2004Lambda As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing Quake-type load pattern.</p>
<p class="ParameterName">DirFlag</p>
<p class="Comment">This is 1 or 2, indicating the seismic load direction.</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">1 = Global X</p>
<p class="Comment" style="margin-left: 88px;">2 = Global Y</p>
<p class="ParameterName">Eccen</p>
<p class="Comment">The eccentricity ratio that applies to all diaphragms.</p>
<p class="ParameterName">PeriodFlag</p>
<p class="Comment">This is 1, 2 or 3, indicating the time period option.</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">1 = Approximate</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">2 = Program calculated</p>
<p class="Comment" style="margin-left: 88px;">3 = User defined</p>
<p class="ParameterName">CT</p>
<p class="Comment">The code-specified Ct factor. This item applies when the PeriodFlag item is 1.</p>
<p class="ParameterName">UserT</p>
<p class="Comment">The user specified time period. This item applies when the PeriodFlag item is 3.[s]</p>
<p class="ParameterName">UserZ</p>
<p class="Comment">This item is True if the top and bottom elevations of the seismic load are user specified. It is False if the elevations are determined by the program.</p>
<p class="ParameterName">TopZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">BottomZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">EURO2004Country</p>
<p class="Comment">This is 0, 1, 5, 6, or 10 indicating the country for which the Nationally Determined Parameters (NDPs) are specified.</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">&#160;&#160;0 = Other (NDPs are user specified)</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">&#160;&#160;1 = CEN Default</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">&#160;&#160;5 = Norway</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">&#160;6 = Singapore<br>
10 = Portugal</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">&#160;</p>
<p class="ParameterName">EURO2004SpectrumType</p>
<p class="Comment">This is 1 or 2, indicating the spectrum type.</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">1 = Type 1</p>
<p class="Comment" style="margin-left: 88px;">2 = Type 2 (Does not apply when EURO2004Country = 6)</p>
<p class="ParameterName">EURO2004GroundType</p>
<p class="Comment">This is 1, 2, 3, 4, 5, or 6, indicating the ground type.</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">1 = A (Does not apply when EURO2004Country = 6)</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">2 = B (Does not apply when EURO2004Country = 6)</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">3 = C</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">4 = D</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">5 = E (Does not apply when EURO2004Country = 6)</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">6 = S1 (Only applies when EURO2004Country = 6)</p>
<p class="Comment" style="margin-bottom: 0pt; margin-left: 88px;">&#160;</p>
<p class="ParameterName">EURO2004ag</p>
<p class="Comment">The design ground acceleration in g, ag.</p>
<p class="ParameterName">EURO2004S</p>
<p class="Comment">The soil factor, S. If the EURO2004Country item is not 0, the input value for this item is ignored.</p>
<p class="ParameterName">EURO2004Tb</p>
<p class="Comment">The lower limit of period of the constant spectral acceleration branch, Tb. If the EURO2004Country item is not 0, the input value for this item is ignored.</p>
<p class="ParameterName">EURO2004Tc</p>
<p class="Comment">The upper limit of period of the constant spectral acceleration branch, Tc. If the EURO2004Country item is not 0, the input value for this item is ignored.</p>
<p class="ParameterName">EURO2004Td</p>
<p class="Comment">The period defining the start of the constant displacement range, Td. If the EURO2004Country item is not 0, the input value for this item is ignored.</p>
<p class="ParameterName">EURO2004Beta</p>
<p class="Comment">The lower bound factor, Beta. If the EURO2004Country item is not 0, the input value for this item is ignored.</p>
<p class="ParameterName">EURO2004q</p>
<p class="Comment">The behavior factor, q.</p>
<p class="ParameterName">EURO2004Lambda</p>
<p class="Comment">The correction factor, Lambda.</p>
<h2>Remarks</h2>
<p class="Comment">This function assigns auto seismic loading parameters for the Eurocode 8 2004 code.</p>
<p class="Comment">The function returns zero if the parameters are successfully assigned; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub AssignSeismicEurocode82004()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)<br>
<br>
&#160;&#160;&#160;'assign Eurocode 8 2004 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.SetEurocode82004_1("EQX", 2, 0.1, 2, 0.075, 0, False, 0, 0, 1, 1, 2, 0.4, 1, 1, 1, 1, 0.2, 2, 1)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 14.1.0.</p>
<p class="Comment">This function supersedes <a href="../../../Obsolete_Functions/SetEurocode82004_(Auto_Seismic).htm">SetEurocode82004</a>.</p>
<p class="Comment">Added Portugal as a Country parameter in SAP2000 Version 15.0.0 and CSiBridge Version 15.1.0.</p>
<p class="Comment">Added Singapore as a Country parameter in v20.1.0.</p>
<h2>See Also</h2>
<p class="Comment"><a href="GetEurocode82004_1_{Auto_Seismic}.htm">GetEurocode82004_1</a></p>
</body>
</html>
