
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetNTC2018 {Auto Seismic}</title>
<link rel="StyleSheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body>
<script type="text/javascript" src="../../../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>GetNTC2018</h1>
<h2 class="Block-Text">Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadPatterns.AutoSeismic.GetNTC2018</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetNTC2018(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double, ByRef PeriodFlag As Long, ByRef UserT As Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef ParamsOption As Long, ByRef Latitude As Double, ByRef Longitude As Double, ByRef Island As Long, ByRef LimitState As Long, ByRef UsageClass As Long, ByRef NomLife As Double, ByRef PeakAccel As Double, ByRef F0 As Double, ByRef Tcs As Double, ByRef SpecType As Long, ByRef SoilType As Long, ByRef Topography As Long, ByRef hRatio As Double, ByRef Damping As Double, ByRef q As Double, ByRef lambda As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing Quake-type load pattern with a NTC 2018 auto seismic load assignment.</p>
<p class="ParameterName">DirFlag</p>
<p class="Comment">This is either 1 or 2, indicating the seismic load direction.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Global X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Global Y</p>
<p class="ParameterName">Eccen</p>
<p class="Comment">The eccentricity ratio that applies to all diaphragms.</p>
<p class="ParameterName">PeriodFlag</p>
<p class="Comment">This is 1, 2 or 3, indicating the time period option.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Approximate</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Program calculated</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = User defined</p>
<p class="ParameterName">UserT</p>
<p class="Comment">The user specified time period. This item is meaningful when the PeriodFlag item is 3. [s]</p>
<p class="ParameterName">UserZ</p>
<p class="Comment">This item is True if the top and bottom elevations of the seismic load are user specified. It is False if the elevations are determined by the program.</p>
<p class="ParameterName">TopZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">BottomZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">ParamsOption</p>
<p class="Comment">This is 1, 2, or 3, indicating the option for defining the parameters.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = by latitude and longitude</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = by island</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">3 = user specified</p>
<p class="ParameterName">Latitude, Longitude</p>
<p class="Comment">The latitude and longitude for which the seismic coefficients are obtained. These items are meaningful only when ParamsOption = 1.</p>
<p class="ParameterName">Island</p>
<p class="Comment">This is one of the following values. This item is used only when ParamsOption = 2.</p>
<p class="Comment" style="margin-left: 84px;"><span lang="IT" xml:lang="IT" style="line-height: 107%; font-family: 'Times New Roman', serif; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">1 = Alicudi<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">2 = Arcipelago Toscano<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">3 = Filcudi<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">4 = Isole Egadi<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">5 = Lampedusa<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">6 = Linosa<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">7 = Lipari<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">8 = Palmarola<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">9 = Panarea<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span style="mso-tab-count: 1; line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">1</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">0 = Pantelleria<br></span><span style="mso-tab-count: 1; font-size: 10pt;">&#160;</span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">11 = Ponza<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">12 = Salina<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">13 = Santo Stefano<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">14 = Sardegna<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">15 = Stromboli<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">16 = Tremiti<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">17 = Ustica<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">18 = Ventotene<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">19 = Vulcano<br></span><span lang="IT" xml:lang="IT" style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: IT; mso-fareast-language: EN-US; mso-bidi-language: AR-SA; font-size: 10pt;">20 = Zannone</span></p>
<p class="ParameterName">LimitState</p>
<p class="Comment">This is 1, 2, 3, or 4, indicating the limit state.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = SLO</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = SLD</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = SLV</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">4 = SLC</p>
<p class="ParameterName">UsageClass</p>
<p class="Comment">This is 1, 2, 3, or 4, indicating the usage class.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = I</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = II</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = III</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">4 = IV</p>
<p class="ParameterName">NomLife</p>
<p class="Comment">The nominal life to be considered.</p>
<p class="ParameterName">PeakAccel</p>
<p class="Comment">The peak ground acceleration, ag/g.</p>
<p class="ParameterName">F0</p>
<p class="Comment">The magnitude factor, F0.</p>
<p class="ParameterName">Tcs</p>
<p class="Comment">The reference period, Tc* [s].</p>
<p class="ParameterName">SpecType</p>
<p class="Comment">This is 1, 2, 3, or 4, indicating the type of spectrum to consider.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Elastic horizontal</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Elastic vertical</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = Design horizontal</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">4 = Design vertical</p>
<p class="ParameterName">SoilType</p>
<p class="Comment">This is 1, 2, 3, 4, or 5, indicating the subsoil type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = D</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = E</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">&#160;</p>
<p class="ParameterName">Topography</p>
<p class="Comment">This is 1, 2, 3, or 4, indicating the topography type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = T1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = T2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = T3</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">4 = T4</p>
<p class="ParameterName">hRatio</p>
<p class="Comment">The ratio for the site altitude at the base of the hill to the height of the hill.</p>
<p class="ParameterName">Damping</p>
<p class="Comment">The damping, in percent. This is only applicable for SpecType 1 and 2.</p>
<p class="ParameterName">q</p>
<p class="Comment">The behavior correction factor. This is only applicable for SpecType 3 and 4.</p>
<p class="ParameterName">lambda</p>
<p class="Comment">A correction factor.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves auto seismic loading parameters for the NTC 2018 code.</p>
<p class="Comment">The function returns zero if the parameters are successfully retrieved; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetSeismicParametersNTC2018()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim DirFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Eccen As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PeriodFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UserT As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UserZ As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim TopZ As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim BottomZ As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;<span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">Dim ParamsOption As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Latitude As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Longitude As Double<br></span><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span><span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">&#160;Dim Island As Long<br></span><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span><span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">&#160;Dim LimitState As Long<br></span><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span><span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">&#160;Dim UsageClass As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NomLife As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PeakAccel As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim F0 As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Tcs As Double<br></span><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span><span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">&#160;Dim SpecType As Long<br></span><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span><span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">&#160;Dim SoilType As Long<br></span><span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;&#160;</span><span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">&#160;Dim Topography As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim hRatio As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Damping As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim q As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim lambda As Double</span><span style="font-size: 12.0pt; line-height: 107%; font-family: 'Times New Roman', serif; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;"><br style="mso-special-character: line-break;"></span><br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)<br>
<br>
&#160;&#160;&#160;'add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add("EQX", eLoadPatternType_QUAKE)<br>
<br>
&#160;&#160;&#160;'assign NTC2018 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.SetNTC2018("EQX", 1, 0.05, 1, 0, False, 0, 0, 3, 0, 0, 1, 1, 1, 50, 0.2, 2.4, 0.3, 3, 2, 1, 1, 5, 1, 0.85 )<br>
<br>
&#160;&#160;&#160;'get NTC2018 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.GetNTC2018("EQX", DirFlag, Eccen, PeriodFlag, UserT, UserZ, TopZ, BottomZ, <span style="line-height: 107%; mso-fareast-font-family: 'Times New Roman'; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;">ParamsOption, Latitude, Longitude, Island, LimitState, UsageClass, NomLife, PeakAccel, F0, Tcs, SpecType, SoilType, Topography, hRatio, Damping, q, lambda)</span><br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in v20.1.0.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetNTC2018_{Auto_Seismic}.htm">SetNTC2018</a></p>
</body>
</html>
