
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Load Case Functions\Auto Seismic Load Functions\GetUBC97.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetUBC97 {Auto Seismic}</title>
<link rel="stylesheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../../ehlpdhtm.js"></script>

<h1>GetUBC97</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadPatterns.AutoSeismic.GetUBC97</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetUBC97(ByVal Name As String, ByRef DirFlag As Long, ByRef Eccen As Double, ByRef PeriodFlag As Long, ByRef CT As Double, ByRef UserT As Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef UBC97SeismicCoeffFlag As Long, ByRef UBC97SoilProfileType As Long, ByRef UBC97Z As Double, ByRef UBC97Ca As Double, ByRef UBC97Cv As Double, ByRef UBC97NearSourceFlag As Long, ByRef UBC97SourceType As Long, ByRef UBC97Dist As Double, ByRef UBC97Na As Double, ByRef UBC97Nv As Double, ByRef UBC97I As Double, ByRef UBC97R As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing Quake-type load pattern with a UBC97 auto seismic load assignment.</p>
<p class="ParameterName">DirFlag</p>
<p class="Comment">This is either 1 or 2, indicating the seismic load direction.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Global X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Global Y</p>
<p class="ParameterName">Eccen</p>
<p class="Comment">The eccentricity ratio that applies to all diaphragms.</p>
<p class="ParameterName">PeriodFlag</p>
<p class="Comment">This is 1, 2 or 3, indicating the time period option.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Approximate</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Program calculated</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: 9pt; margin-left: 88px;">3 = User defined</p>
<p class="ParameterName">CT</p>
<p class="Comment">The code-specified CT factor. This item applies when the PeriodFlag item is 1 or 2.</p>
<p class="ParameterName">UserT</p>
<p class="Comment">The user specified time period. This item applies when the PeriodFlag item is 3. [s]</p>
<p class="ParameterName">UserZ</p>
<p class="Comment">This item is True if the top and bottom elevations of the seismic load are user specified. It is False if the elevations are determined by the program.</p>
<p class="ParameterName">TopZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">BottomZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest level where auto seismic loads are applied. [L]</p>
<p class="ParameterName">UBC97SeismicCoeffFlag</p>
<p class="Comment">This is either 1 or 2, indicating if the seismic coefficients Ca and Cv are per code or user defined.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Per code</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = User defined</p>
<p class="ParameterName">UBC97SoilProfileType</p>
<p class="Comment">This is 1, 2, 3, 4 or 5, indicating the soil profile type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = SA</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = SB</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = SC</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = SD</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = SE</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">This item is applicable only when the seismic coefficients Ca and Cv are calculated per code (UBC97SeismicCoeffFlag = 1).</p>
<p class="ParameterName">UBC97Z</p>
<p class="Comment">This is 0.075, 0.15, 0.2, 0.3 or 0.4, indicating the seismic zone factor.</p>
<p class="Comment">This item is applicable only when the seismic coefficients Ca and Cv are calculated in accordance with code (UBC97SeismicCoeffFlag = 1).</p>
<p class="ParameterName">UBC97Ca</p>
<p class="Comment">The seismic coefficient, Ca.</p>
<p class="ParameterName">UBC97Cv</p>
<p class="Comment">The seismic coefficient, Cv.</p>
<p class="ParameterName">UBC97NearSourceFlag</p>
<p class="Comment">This is 1 or 2, indicating if the near source factor coefficients Na and Nv are per code or user defined.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Per code</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = User defined</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">This item is applicable only when the seismic coefficients Ca and Cv are calculated per code (UBC97SeismicCoeffFlag = 1) and UBC97Z = 0.4.</p>
<p class="ParameterName">UBC97SourceType</p>
<p class="Comment">This is 1, 2 or 3, indicating the seismic source type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">This item is applicable only when the seismic coefficients Ca and Cv are calculated per code (UBC97SeismicCoeffFlag = 1), UBC97Z = 0.4, and the near source factor coefficients Na and Nv are calculated per code (UBC97NearSourceFlag = 1).</p>
<p class="ParameterName">UBC97Dist</p>
<p class="Comment">This is the distance to the seismic source in kilometers.</p>
<p class="Comment">This item is only applicable when the seismic coefficients Ca and Cv are calculated per code (UBC97SeismicCoeffFlag = 1), UBC97Z = 0.4, and the near source factor coefficients Na and Nv are calculated per code (UBC97NearSourceFlag = 1).</p>
<p class="ParameterName">UBC97Na</p>
<p class="Comment">The near source factor coefficient, Na.</p>
<p class="Comment">This item is applicable only when the seismic coefficients Ca and Cv are user defined (UBC97SeismicCoeffFlag = 2).</p>
<p class="ParameterName">UBC97Nv</p>
<p class="Comment">The near source factor coefficient, Nv.</p>
<p class="Comment">This item is applicable only when the seismic coefficients Ca and Cv are user defined (UBC97SeismicCoeffFlag = 2).</p>
<p class="ParameterName">UBC97I</p>
<p class="Comment">The importance factor.</p>
<p class="ParameterName">UBC97R</p>
<p class="Comment">The overstrength factor.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves auto seismic loading parameters for the 1997 UBC code.</p>
<p class="Comment">The function returns zero if the parameters are successfully retrieved; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetSeismicParametersUBC97()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim DirFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Eccen As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PeriodFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim CT As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UserT As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UserZ As Boolean<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim TopZ As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim BottomZ As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97SeismicCoeffFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97SoilProfileType As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97Z As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97Ca As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97Cv As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97NearSourceFlag As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97SourceType As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97Dist As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97Na As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97Nv As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97I As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim UBC97R As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)<br>
<br>
&#160;&#160;&#160;'add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add("EQX", LTYPE_QUAKE)<br>
<br>
&#160;&#160;&#160;'assign UBC97 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.SetUBC97("EQX", 1, 0.05, 1, 0.035, 0, False, 0, 0, 1, 3, 0.4, 0, 0, 1, 3, 5, 0, 0, 1.15, 6)<br>
<br>
&#160;&#160;&#160;'get UBC97 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoSeismic.GetUBC97("EQX", DirFlag, Eccen, PeriodFlag, CT, UserT, UserZ, TopZ, BottomZ, UBC97SeismicCoeffFlag, UBC97SoilProfileType, UBC97Z, UBC97Ca, UBC97Cv, UBC97NearSourceFlag, UBC97SourceType, UBC97Dist, UBC97Na, UBC97Nv, UBC97I, UBC97R)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.01.</p>
<p class="Comment">Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load Patterns, Load Cases and Load Combinations, respectively, in version 12.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetUBC97_{Auto_Seismic}.htm">SetUBC97</a></p>
</body>
</html>
