
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetSP20133302016 {Wind Load}</title>
<link rel="StyleSheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body>
<script type="text/javascript" src="../../../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>GetSP20133302016</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadPatterns.AutoWind.GetSP20133302016</p>
<h2 class="Comment">VB6 Procedure</h2>
<p class="Comment">Function GetSP20133302016 (ByVal Name As String, ByRef LoadingType As Long, ByRef ExposureFrom As Long, ByRef DirAngle As Double, ByRef Cp As Double, ByRef UserZ As Boolean, ByRef TopZ As Double, ByRef BottomZ As Double, ByRef StructureType As Integer, ByRef LogDecrement As Integer, ByRef BuildingWidth As Double, ByRef BuildingDepth As Double, ByRef Zeq As Double, ByRef WindDistrict As Long, ByRef WindPressure As Double, ByRef TerrainType As Long, ByRef LimitFreq As Double, ByRef ModalCase As String, ByRef FirstValMode As Long, ByRef UserExposure As Boolean) As Long</p>
<h2 class="Comment">Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing Wind-type load pattern with a SP 20.13330.2016 auto wind assignment.</p>
<p class="ParameterName">LoadingType</p>
<p class="Comment">This indicates whether the loads should be calculated as static or dynamic.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Static</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Dynamic</p>
<p class="ParameterName">ExposureFrom</p>
<p class="Comment">This is 1 or 2, indicating the source of the wind exposure. This item applies only when LoadingType = 1. &#160;</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = From extents of rigid diaphragms</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = From area objects</p>
<p class="ParameterName">DirAngle</p>
<p class="Comment">The direction angle for the wind load. This item does not apply when ExposureFrom = 2.</p>
<p class="ParameterName">Cp</p>
<p class="Comment">The wind coefficient, Cp. This item applies only when LoadingType = 1 and ExposureFrom = 1.</p>
<p class="ParameterName">UserZ</p>
<p class="Comment">This item is True if the top and bottom elevations of the wind load are user specified. It is False if the elevations are determined by the program.</p>
<p class="ParameterName">TopZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the highest level where auto wind loads are applied. [L]</p>
<p class="ParameterName">BottomZ</p>
<p class="Comment">This item applies only when the UserZ item is True. It is the global Z-coordinate at the lowest level where auto wind loads are applied. [L]</p>
<p class="ParameterName">StructureType</p>
<p class="Comment">This indicates the structure type for calculating the wind pressure.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Building</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Other</p>
<p class="ParameterName">LogDecrement</p>
<p class="Comment">This specifies a value for the logarithmic decrement. This item applies only when LoadingType = 2.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = 0.15</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = 0.30</p>
<p class="ParameterName">BuildingWidth</p>
<p class="Comment">This is the building width, normal to the wind direction. [L]</p>
<p class="ParameterName">BuildingDepth</p>
<p class="Comment">This is the building depth, in the direction of the wind. This item applies only when LoadingType = 2. [L]</p>
<p class="ParameterName">Zeq</p>
<p class="Comment">This is the equivalent height, Zeq, of the structure. This item applies only when LoadingType = 2. [L]</p>
<p class="ParameterName">WindDistrict</p>
<p class="Comment">This is the wind district to consider.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">0 = Ia</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = I</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = II</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = III</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = IV</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = V</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">6 = VI</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">7 = VII</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">8 = User Defined</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">&#160;</p>
<p class="ParameterName">WindPressure</p>
<p class="Comment">This is the wind pressure. This item applies only when WindDistrict = 8. [F/L<sup>2</sup>]</p>
<p class="ParameterName">TerrainType</p>
<p class="Comment">This is the terrain type being considered.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">&#160;</p>
<p class="ParameterName">LimitFreq</p>
<p class="Comment">The limit frequency. This item applies only when LoadingType = 2 and WindDistrict = 8.</p>
<p class="ParameterName">ModalCase</p>
<p class="Comment">The name of an existing modal load case to be used in determining dynamic wind loads. This item applies only when LoadingType = 2.</p>
<p class="ParameterName">FirstValMode</p>
<p class="Comment">The first valuable mode number from the specified modal case. This item applies only when LoadingType = 2.</p>
<p class="ParameterName">UserExposure</p>
<p class="Comment">If this item is True, the wind exposure widths are provided by the user. If it is False, the wind exposure widths are calculated by the program from the extents of the diaphragms. This item applies only when LoadingType = 1.</p>
<h2 class="Comment">Remarks</h2>
<p class="Comment">This function retrieves auto wind loading parameters for SP 20.13330.2016.</p>
<p class="Comment">The function returns zero if the parameters are successfully assigned; otherwise it returns a nonzero value.</p>
<h2 class="Comment">VBA Example</h2>
<p class="Coding">Sub GetWindSP20133302016()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long</p>
<p class="Coding">&#160;</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim LoadingType As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim ExposureFrom As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim DirAngle As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim Cp As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim UserZ As Boolean</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim TopZ As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim BottomZ As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim StructureType As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim LogDecrement As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim BuildingWidth As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim Building Depth As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim Zeq As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim WindDistrict As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim WindPressure As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim TerrainType As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim LimitFreq As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim ModalCase As String</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim FirstValMode As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim UserExposure As Boolean</p>
<p class="Coding">&#160;</p>
<p class="Coding">&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel</p>
<p class="Coding">&#160;</p>
<p class="Coding">&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New3DFrame(BeamSlab, 2, 144, 3, 336, 2, 432)</p>
<p class="Coding">&#160;</p>
<p class="Coding">&#160;&#160;&#160;'define diaphragm constraints<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.ConstraintDef.SetDiaphragm("Diaph1", Z)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.ConstraintDef.SetDiaphragm("Diaph2", Z)<br>
<br>
&#160;&#160;&#160;'assign points to diaphragm<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.SelectObj.ClearSelection</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.SelectObj.PlaneXY("2")<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PointObj.SetConstraint("", "Diaph1", SelectedObjects)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.SelectObj.ClearSelection<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.SelectObj.PlaneXY("3")<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PointObj.SetConstraint("", "Diaph2", SelectedObjects)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.SelectObj.ClearSelection<br>
<br>
&#160;&#160;&#160;'add new load pattern<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.Add("WIND", LTYPE_WIND)</p>
<p class="Coding">&#160;</p>
<p class="Coding">&#160;&#160;&#160;'assign SP 20.13330.2016 parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoWind.SetSP20133302016("WIND", 1, 1, 0, 0.8, False, 0, 0, 1, 1, 10, 10, 10, 3, 0.1, 2, 10, “MODAL”, 1)</p>
<p class="Coding"><br>
&#160;&#160;&#160;'get SP 20.13330.2016 parameters</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadPatterns.AutoWind.GetSP20133302016("WIND", LoadingType, ExposureFrom, DirAngle, Cp, UserZ, TopZ, BottomZ, StructureType, LogDecrement, BuildingWidth, BuildingDepth, Zeq, WindDistrict, WindPressure, TerrainType, LimitFreq, ModalCase, FirstValMode, UserExposure)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<p class="Coding">&#160;</p>
<h2 class="Coding">Release Notes</h2>
<p class="Comment">Initial release in v21.0.0.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetSP20133302016_{Wind_Load}.htm">SetSP20133302016</a></p>
<p class="Block-Text">&#160;</p>
</body>
</html>
