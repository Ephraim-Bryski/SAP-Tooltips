
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta http-equiv="Content-Language" content="en-US">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>Set Mass Source</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body>
<script type="text/javascript" src="../../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>Set Mass Source</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.SourceMass.SetMassSource</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetMassSource(ByVal Name As String, ByVal MassFromElements As Boolean, ByVal MassFromMasses As Boolean, ByVal MassFromLoads As Boolean, ByVal IsDefault As Boolean, ByVal NumberLoads As Long, ByRef LoadPat() As String, ByRef SF() As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The mass source name. If a mass source with this name already exists then the mass source is reinitialized with the new data.<span style="mso-spacerun: yes;">&#160;</span>&#160;All previous data assigned to the mass source is lost. If a mass source with this name does not exist then a new mass source is added.</p>
<p class="ParameterName">MassFromElements</p>
<p class="Comment">If this item is True then element self mass is included in the mass.</p>
<p class="ParameterName">MassFromMasses</p>
<p class="Comment">If this item is True then assigned masses are included in the mass.</p>
<p class="ParameterName">MassFromLoads</p>
<p class="Comment">If this item is True then specified load patterns are included in the mass.</p>
<p class="ParameterName">IsDefault</p>
<p class="Comment">If this item is True then the mass source is the default mass source.<span style="mso-spacerun: yes;">&#160;</span>&#160;Only one mass source can be the default mass source so when this assignment is True all other mass sources are automatically set to have the IsDefault flag False.</p>
<p class="ParameterName">NumberLoads</p>
<p class="Comment">The number of load patterns specified for the mass source.<span style="mso-spacerun: yes;">&#160;</span>&#160;This item is only applicable when the MassFromLoads item is True.</p>
<p class="ParameterName">LoadPat</p>
<p class="Comment">This is an array of load pattern names specified for the mass source.</p>
<p class="ParameterName">SF</p>
<p class="Comment">This is an array of load pattern multipliers specified for the mass source.</p>
<h2><b style="mso-bidi-font-weight: normal;">Remarks</b></h2>
<p class="Comment">This function adds a new mass source to the model or reinitializes an existing mass source.</p>
<p class="Comment">The function returns zero if the mass source is successfully added or initialized, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub SetMassSource()</p>
<p class="Coding" style="margin-left: 72px;">'dimension variables</p>
<p class="Coding" style="margin-left: 96px;">Dim SapObject as cOAPI</p>
<p class="Coding" style="margin-left: 96px;">Dim SapModel As cSapModel</p>
<p class="Coding" style="margin-left: 96px;">Dim ret As Long</p>
<p class="Coding" style="margin-left: 96px;">Dim LoadPat(0) As String</p>
<p class="Coding" style="margin-left: 96px;">Dim SF(0) As Double</p>
<p class="Coding" style="margin-left: 96px;">&#160;</p>
<p class="Coding" style="margin-left: 72px;">'create Sap2000 object</p>
<p class="Coding" style="margin-left: 96px;">Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")</p>
<p class="Coding" style="margin-left: 96px;">&#160;</p>
<p class="Coding" style="margin-left: 72px;">'start Sap2000 application</p>
<p class="Coding" style="margin-left: 96px;">SapObject.ApplicationStart</p>
<p class="Coding" style="margin-left: 96px;">&#160;</p>
<p class="Coding" style="margin-left: 72px;">'create SapModel object</p>
<p class="Coding" style="margin-left: 96px;">Set SapModel = SapObject.SapModel</p>
<p class="Coding" style="margin-left: 96px;">&#160;</p>
<p class="Coding" style="margin-left: 72px;">'initialize model</p>
<p class="Coding" style="margin-left: 96px;">ret = SapModel.InitializeNewModel</p>
<p class="Coding" style="margin-left: 96px;">&#160;</p>
<p class="Coding" style="margin-left: 72px;">'create model from template</p>
<p class="Coding" style="margin-left: 96px;">ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)</p>
<p class="Coding" style="margin-left: 96px;">&#160;</p>
<p class="Coding" style="margin-left: 72px;">'add a new mass source and make it the default mass source</p>
<p class="Coding" style="margin-left: 96px;">LoadPat(0) = "DEAD"</p>
<p class="Coding" style="margin-left: 96px;">SF(0) = 1.25</p>
<p class="Coding" style="margin-left: 96px;">ret = SapModel.SourceMass.SetMassSource("MyMassSource", True, True, True, True, 1, LoadPat, SF)</p>
<p class="Coding" style="margin-left: 96px;">&#160;</p>
<p class="Coding" style="margin-left: 72px;">'close Sap2000</p>
<p class="Coding" style="margin-left: 96px;">SapObject.ApplicationExit False</p>
<p class="Coding" style="margin-left: 96px;">Set SapModel = Nothing</p>
<p class="Coding" style="margin-left: 96px;">Set SapObject = Nothing</p>
<p class="Coding">End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 16.0.0.</p>
<h2>See Also</h2>
</body>
</html>
