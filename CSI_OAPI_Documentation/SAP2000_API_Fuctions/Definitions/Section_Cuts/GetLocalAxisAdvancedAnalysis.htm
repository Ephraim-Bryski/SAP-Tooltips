
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta http-equiv="Content-Language" content="en-US">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetLocalAxisAdvancedAnalysis</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>GetLocalAxisAdvancedAnalysis</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.SectCut.GetLocalAxesAdvancedAnalysis</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetLocalAxesAdvancedAnalysis(ByVal Name As String, ByRef Active As Boolean, ByRef AxVectOpt As Long, ByRef AxCSys As String, ByRef axdir() As Long, ByRef AxPt() As String, ByRef AxVect() As Double, ByRef Plane2 As Long, ByRef PlVectOpt As Long, ByRef PlCSys As String, ByRef PlDir() As Long, ByRef PlPt() As String, ByRef PlVect() As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">&#160;</p>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing section cut.</p>
<p class="ParameterName">Active</p>
<p class="Comment">This is True if advanced local axes exist.</p>
<p class="ParameterName">AxVectOpt, PlVectOpt</p>
<p class="Comment">This is 1, 2 or 3, indicating the axis/plane reference vector option. This item applies only when the Active item is True.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">1 = Coordinate direction</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">2 = Two joints</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">3 = User vector</p>
<p class="ParameterName">&#160;</p>
<p class="ParameterName">AxCSys, PlCSys</p>
<p class="Comment">The coordinate system used to define the axis/plane reference vector coordinate directions and the axis/plane user vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1 or 3.</p>
<p class="ParameterName">AxDir, PlDir</p>
<p class="Comment">This is an array dimensioned to 1 (2 integers), indicating the axis/plane reference vector primary and secondary coordinate directions, PlDir(0) and PlDir(1) respectively, taken at the object center in the specified coordinate system and used to determine the plane reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 1. Possible coordinate direction values are:</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">1 = +X<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-1 = -X</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">2 = +Y<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-2 = -Y</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">3 = +Z<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-3 = -Z</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">4 = +CR<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-4 = -CR</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">5 = +CA<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-5 = -CA</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">6 = +CZ<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-6 = -CZ</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">7 = +SR<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-7 = -SR</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">8 = +SA<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-8 = -SA</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">9 = +SB<span style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&#160;-9 = -SB</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 1.0in; margin-bottom: .0001pt;">&#160;</p>
<p class="ParameterName">AxPt, PlPt</p>
<p class="Comment">This is an array dimensioned to 1 (2 strings), indicating the labels of two joints that define the axis/plane reference vector. Either of these joints may be specified as None to indicate the center of the specified object.&#160;&#160;If both joints are specified as None, they are not used to define the plane reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 2.</p>
<p class="ParameterName">AxVect, PlVect</p>
<p class="Comment">This is an array dimensioned to 2 (3 doubles) that defines the axis/plane reference vector. This item applies when the Active item is True and the AxVectOpt/PlVectOpt item is 3.</p>
<p class="ParameterName">Plane2</p>
<p class="Comment">This is 12, 13, 21, 23, 31 or 32, indicating that the local plane determined by the plane reference vector is the 1-2, 1-3, 2-1, 2-3, 3-1, 0r 3-2 plane. This item applies only when the Active item is True.</p>
<h2><b style="mso-bidi-font-weight: normal;">Remarks</b></h2>
<p class="Comment">This function gets the advanced local axes data for an existing section cut whose result type is Analysis.</p>
<p class="Comment">The function returns zero if the data is successfully retrieved, otherwise it returns a nonzero value.</p>
<h2 class="Comment">VBA Example</h2>
<p class="CodeName" style="font-family: 'Courier New', monospace; margin-left: 48px;">Sub GetSectionCutLocalAxesAdvancedAnalysis()</p>
<p class="CommentFirstOne" style="font-family: 'Courier New', monospace; margin-left: 72px;">'dimension variables</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim SapObject As Sap2000v16.SapObject</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim SapModel As cSapModel</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim ret As Long</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim Active As Boolean</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim AxVectOpt As Long</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim AxCSys As String</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim MyAxDir() As Long</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim MyAxPt() As String</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim MyAxVect() As Double</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim Plane2 As Long</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim PlVectOpt As Long</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim PlCSys As String</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim MyPlDir() As Long</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim MyPlPt() As String</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Dim MyPlVect() As Double</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'create Sap2000 object</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Set SapObject = New Sap2000v16.SapObject</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'start Sap2000 application</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">SapObject.ApplicationStart</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'create SapModel object</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Set SapModel = SapObject.SapModel</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'initialize model</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.InitializeNewModel</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'create model from template</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'define new group</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.GroupDef.SetGroup("Group1")</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'add objects to group</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.PointObj.SetGroupAssign("1", "Group1")</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.FrameObj.SetGroupAssign("1", "Group1")</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-bottom: 0pt; margin-left: 72px;">'define section cut</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.SectCut.SetByGroup("SCut1", "Group1", 1)</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-bottom: 0pt; margin-left: 72px;">'set section cut advanced local axes data</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Redim MyAxDir(1)</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Redim MyAxPt(1)</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Redim MyAxVect(2)</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Redim MyPlDir(1)</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Redim MyPlPt(1)</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Redim MyPlVect(2)</p>
<p class="Code" style="mso-bidi-font-weight: normal; font-family: 'Courier New', monospace; margin-left: 108px;"><b>MyAxVect(0)=0.707</b></p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">MyAxVect(1)=0.707</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">MyAxVect(2)=0</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">MyPlDir(0) = 2</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">MyPlDir(1) = 3</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.SectCut.SetLocalAxesAdvancedAnalysis("SCut1", True, 3, "Global", MyAxDir, MyAxPt, MyAxVect, 12, 1, "Global", MyPlDir, MyPlPt, MyPlVect)</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'get section cut advanced local axes data</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">ret = SapModel.SectCut.GetLocalAxesAdvancedAnalysis("SCut1", Active, AxVectOpt, AxCSys, MyAxDir, MyAxPt, MyAxVect, Plane2, PlVectOpt, PlCSys, MyPlDir, MyPlPt, MyPlVect)</p>
<p class="Comment" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="Comment" style="font-family: 'Courier New', monospace; margin-left: 72px; margin-bottom: 0pt;">'close Sap2000</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">SapObject.ApplicationExit False</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Set SapModel = Nothing</p>
<p class="Code" style="font-family: 'Courier New', monospace; margin-left: 108px;">Set SapObject = Nothing</p>
<p class="CodeName" style="font-family: 'Courier New', monospace; margin-left: 48px;">&#160;</p>
<p class="CodeName" style="font-family: 'Courier New', monospace; margin-left: 48px;">End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 16.0.0.</p>
<h2>See Also</h2>
<p class="Comment"><a href="GetLocalAxesAnalysys.htm">GetLocalAxesAnalysis</a></p>
<p class="Comment">&#160;</p>
</body>
</html>
