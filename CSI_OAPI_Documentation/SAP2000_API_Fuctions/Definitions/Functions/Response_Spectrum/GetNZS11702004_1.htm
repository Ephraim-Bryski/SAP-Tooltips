
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetNZS11702004_1</title>
<link rel="StyleSheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body>
<script type="text/javascript" src="../../../../ehlpdhtm.js" language="JavaScript1.2"></script>

<h1>GetNZS11702004_1</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.Func.FuncRS.GetNZS11702004_1</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetNZS11702004_1(ByVal Name As String, ByRef NZS2004SpectrumType As Long, ByRef NZS2004SiteClass As Long, ByRef NZS2004Z As Double, ByRef NZS2004R As Double, ByRef NZS2004DIST As Double, ByRef NZS2004ConsiderTSite As Boolean, ByRef NZS2004TSite As Double, ByRef DampRatio As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of a NZS 1170 2004 response spectrum function.</p>
<p class="ParameterName">NZS2004SpectrumType</p>
<p class="Comment">This is 1 or 2, indicating the spectrum type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Horizontal</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Vertical</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">&#160;</p>
<p class="ParameterName">NZS2004SiteClass</p>
<p class="Comment">This is 1, 2, 3, 4 or 5, indicating the site class.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = D</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">5 = E</p>
<p class="ParameterName">NZS2004Z</p>
<p class="Comment">The hazard factor, Z.</p>
<p class="ParameterName">NZS2004R</p>
<p class="Comment">The return period factor, R.</p>
<p class="ParameterName">NZS2004DIST</p>
<p class="Comment">Distance to the fault in km, used to calculate the near fault factor.</p>
<p class="ParameterName">NZS2004ConsiderTSite</p>
<p class="Comment">Indicates whether to consider the site period for the spectral shape factor.</p>
<p class="ParameterName">NZS2004TSite</p>
<p class="Comment">The low amplitude site period.</p>
<p class="ParameterName">DampRatio</p>
<p class="Comment">The damping ratio for the function, 0 &lt;= DampRatio &lt; 1.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves the definition of an NZS 1170 2004 response spectrum function.</p>
<p class="Comment">The function returns zero if the function definition is successfully retrieved; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetRSFuncNZS11702004()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim NZS2004SpectrumType As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NZS2004SiteClass As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NZS2004Z As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NZS2004R As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim NZS2004DIST As Double</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim NZS2004ConsiderTSite As Boolean</p>
<p class="Coding">&#160;&#160;&#160;&#160;&#160;&#160;Dim NZS2004TSite As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim DampRatio As Double<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)<br>
<br>
&#160;&#160;&#160;'add NZS 1170 2004 RS function<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.Func.FuncRS.SetNZS11702004_1("RS-1", 1, 3, 0.4, 1.3, 20, True, 1, 0.04)<br>
<br>
&#160;&#160;&#160;'get NZS 1170 2004 RS function<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.Func.FuncRS.GetNZS11702004_1("RS-1", NZS2004SpectrumType, NZS2004SiteClass, NZS2004Z, NZS2004R, NZS2004DIST, NZS2004ConsiderTSite, NZS2004TSite, DampRatio)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in v21.0.0.</p>
<p class="Comment">This function supersedes <a href="../../../Obsolete_Functions/GetNZS11702004.htm">GetNZS11702004</a></p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetNZS11702004_1.htm">SetNZS11702004_1</a></p>
</body>
</html>
