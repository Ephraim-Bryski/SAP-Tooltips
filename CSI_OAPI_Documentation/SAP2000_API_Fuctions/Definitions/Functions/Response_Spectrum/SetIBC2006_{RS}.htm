
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Response Spectrum Functions\SetIBC2006.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetIBC2006 {RS}</title>
<link rel="stylesheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../../ehlpdhtm.js"></script>

<h1>SetIBC2006</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.Func.FuncRS.SetIBC2006</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetIBC2006(ByVal Name As String, ByVal IBC2006Option As Long, ByVal IBC2006Latitude As Double, ByVal IBC2006Longitude As Double, ByVal IBC2006ZipCode As String, ByVal IBC2006SS As Double, ByVal IBC2006S1 As Double, ByVal IBC2006TL As Double, ByVal IBC2006SiteClass As Long, ByVal IBC2006Fa As Double, ByRef IBC2006Fv As Double, ByVal DampRatio As Double) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing or new function. If this is an existing function then that function is modified; otherwise, a new function is added.</p>
<p class="ParameterName">IBC2006Option</p>
<p class="Comment">This is 0, 1 or 2, indicating the seismic coefficient option.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">0 = Ss and S1 from USGS by latitiude and longitude</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Ss and S1 from USGS by zip code</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Ss and S1 are user defined</p>
<p class="ParameterName">IBC2006Latitude, IBC2006Longitude</p>
<p class="Comment">The latitude and longitude for which the seismic coefficients are obtained. These items are used only when IBC2006Option = 0.</p>
<p class="ParameterName">IBC2006ZipCode</p>
<p class="Comment">The zip code for which the seismic coefficients are obtained. This item is used only when IBC2006Option = 1.</p>
<p class="ParameterName">IBC2006SS, IBC2006S1</p>
<p class="Comment">The seismic coefficients Ss and S1. This item is used only when IBC2006Option = 2.</p>
<p class="ParameterName">IBC2006TL</p>
<p class="Comment">The long-period transition period. [s]</p>
<p class="ParameterName">IBC2006SiteClass</p>
<p class="Comment">This is 1, 2, 3, 4, 5 or 6, indicating the site class.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = A</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = B</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = C</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = D</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = E</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">6 = F</p>
<p class="ParameterName">IBC2006Fa, IBC2006Fv</p>
<p class="Comment">The site coefficients Fa and Fv. These items are used only when IBC2006SiteClass= 6.</p>
<p class="ParameterName">DampRatio</p>
<p class="Comment">The damping ratio for the function, 0 &lt;= DampRatio &lt; 1.</p>
<h2>Remarks</h2>
<p class="Comment">This function defines a IBC2006 response spectrum function.</p>
<p class="Comment">The function returns zero if the function is successfully defined; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub SetRSFuncIBC2006()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)<br>
<br>
&#160;&#160;&#160;'add IBC2006 RS function<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.Func.FuncRS.SetIBC2006("RS-1", 1, 0, 0, "94704", 0, 0, 7.5, 4, 0, 0, 0.04)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.02.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetIBC2006_{RS}.htm">GetIBC2006</a></p>
</body>
</html>
