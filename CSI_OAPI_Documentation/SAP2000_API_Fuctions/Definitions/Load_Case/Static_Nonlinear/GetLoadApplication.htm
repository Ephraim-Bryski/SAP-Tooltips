
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Static Nonlinear\GetLoadApplication.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetLoadApplication</title>
<link rel="stylesheet" href="../../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../../ehlpdhtm.js"></script>

<h1>GetLoadApplication</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.LoadCases.StaticNonlinear.GetLoadApplication</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetLoadApplication(ByVal Name As String, ByRef LoadControl As Long, ByRef DispType As Long, ByRef Displ As Double, ByRef Monitor As Long, ByRef DOF As Long, ByRef PointName As String, ByRef GDispl As String) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing static nonlinear load case.</p>
<p class="ParameterName">LoadControl</p>
<p class="Comment">This is either 1 or 2, indicating the load application control method.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Full load</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Displacement control</p>
<p class="ParameterName">DispType</p>
<p class="Comment">This is either 1 or 2, indicating the control displacement type.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Conjugate displacement</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = Monitored displacement</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">This item applies only when displacement control is used, that is, LoadControl = 2.</p>
<p class="ParameterName">Displ</p>
<p class="Comment">This item applies only when displacement control is used, that is, LoadControl = 2. The structure is loaded to a monitored displacement of this magnitude. [L] when DOF = 1, 2 or 3 and [rad] when DOF = 4, 5 or 6</p>
<p class="ParameterName">Monitor</p>
<p class="Comment">This is either 1 or 2, indicating the monitored displacement.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = Displacement at a specified point object</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-left: 88px; margin-bottom: 9pt;">2 = Generalized displacement</p>
<p class="ParameterName">DOF</p>
<p class="Comment">This is 1, 2, 3, 4, 5 or 6, indicating the degree of freedom for which the displacement at a point object is monitored.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">1 = U1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">2 = U2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">3 = U3</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">4 = R1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">5 = R2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 88px;">6 = R3</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: .5in;">&#160;</p>
<p class="Comment">This item applies only when Monitor = 1.</p>
<p class="ParameterName">PointName</p>
<p class="Comment">The name of the point object at which the displacement is monitored. This item applies only when Monitor = 1.</p>
<p class="ParameterName">GDispl</p>
<p class="Comment">The name of the generalized displacement for which the displacement is monitored. This item applies only when Monitor = 2.</p>
<h2>Remarks</h2>
<p class="Comment">This function retrieves the load application control parameters for the specified load case.</p>
<p class="Comment">The function returns zero if the parameters are successfully retrieved; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetCaseStaticNonlinearLoadApplication()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SF() As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim LoadControl As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim DispType As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Displ As Double<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Monitor As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim DOF As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim PointName As String<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim GDispl As String<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)<br>
<br>
&#160;&#160;&#160;'add generalized displacement<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.GDispl.Add("GD1", 1)<br>
<br>
&#160;&#160;&#160;'add point to generalized displacement<br>
&#160;&#160;&#160;&#160;&#160;&#160;ReDim SF(5)<br>
&#160;&#160;&#160;&#160;&#160;&#160;SF(0) = 0.5<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.GDispl.SetPoint("GD1", "2", SF)<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.GDispl.SetPoint("GD1", "3", SF)<br>
<br>
&#160;&#160;&#160;'add static nonlinear load case<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadCases.StaticNonlinear.SetCase("LCASE1")<br>
<br>
&#160;&#160;&#160;'set load application parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadCases.StaticNonlinear.SetLoadApplication("LCASE1", 2, 1, 12, 2, 0, "", "GD1")<br>
<br>
&#160;&#160;&#160;'get load application parameters<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.LoadCases.StaticNonlinear.GetLoadApplication("LCASE1", LoadControl, DispType, Displ, Monitor, DOF, PointName, GDispl)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.02.</p>
<p class="Comment">Changed nomenclature from Load Cases, Analysis Cases and Response Combinations to Load Patterns, Load Cases and Load Combinations, respectively, in version 12.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetLoadApplication.htm">SetLoadApplication</a></p>
</body>
</html>
