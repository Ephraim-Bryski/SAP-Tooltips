
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\Constraint Definition Functions\GetRod.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>GetRod</title>
<link rel="StyleSheet" href="../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US"><a name="642b3b9347ca42c9b00b820c00c373fa=1"></a>
<script type="text/javascript" src="../../../ehlpdhtm.js"></script>

<h1>GetRod</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.ConstraintDef.GetRod</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function GetRod(ByVal Name As String, ByRef Axis As eConstraintAxis, ByRef CSys As String) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing constraint.</p>
<p class="ParameterName">Axis</p>
<p class="Comment">This is one of the following items from the eConstraintAxis enumeration. It specifies the axis in the specified coordinate system that is parallel to the axis of the constraint. If AutoAxis is specified, the axis of the constraint is automatically determined from the joints assigned to the constraint.</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 84px;">X = 1</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 84px;">Y = 2</p>
<p class="ParameterDescription" style="margin-top: 0in; margin-right: 0in; margin-bottom: .0001pt; margin-left: 84px;">Z = 3</p>
<p class="ParameterDescription" style="margin-left: 84px;">AutoAxis = 4</p>
<p class="ParameterName">CSys</p>
<p class="Comment">The name of the coordinate system in which the constraint is defined.</p>
<h2>Remarks</h2>
<p class="Comment">The function returns the definition for the specified constraint.</p>
<p class="Comment">The function returns zero if the constraint data is successfully obtained, otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub GetRodConstraint()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ConstraintType As eConstraintType<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim Axis As eConstraintAxis<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim CSys as String<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 3, 124, 3, 200)<br>
<br>
&#160;&#160;&#160;'define new constraint<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.ConstraintDef.SetRod("Rod1")<br>
<br>
&#160;&#160;&#160;'get constraint data<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.ConstraintDef.GetConstraintType("Rod1", ConstraintType)<br>
&#160;&#160;&#160;&#160;&#160;&#160;If ConstraintType = CONSTRAINT_ROD Then<br>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.ConstraintDef.GetRod("Rod1", Axis, CSys)<br>
&#160;&#160;&#160;&#160;&#160;&#160;End If<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 11.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="SetRod.htm">SetRod</a></p>
</body>
</html>
