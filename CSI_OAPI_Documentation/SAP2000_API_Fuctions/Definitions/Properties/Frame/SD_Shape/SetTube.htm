
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="F:\Documents and Settings\Nancy\My Documents\SharedFiles\API\SDShape\SetTube.doc">
<meta name="topic-status" content="In Progress">
<meta name="topic-priority" content="0">
<meta name="topic-time-estimate" content="0">
<meta name="topic-id" content="">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>SetTube</title>
<link rel="StyleSheet" href="../../../../../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US">
<script type="text/javascript" src="../../../../../ehlpdhtm.js"></script>

<h1>SetTube</h1>
<h2>Syntax</h2>
<p class="Comment">SapObject.SapModel.PropFrame.SDShape.SetTube</p>
<h2>VB6 Procedure</h2>
<p class="Comment">Function SetTube(ByVal Name As String, ByRef ShapeName As String, ByVal MatProp As String, ByVal PropName As String, ByVal XCenter As Double, ByVal YCenter As Double, ByVal Rotation As Double, Optional ByVal Color As Long = -1, Optional ByVal h As Double = 24, Optional ByVal w As Double = 24, Optional ByVal tf As Double = 2.4, Optional ByVal tw As Double = 2.4) As Long</p>
<h2>Parameters</h2>
<p class="ParameterName">Name</p>
<p class="Comment">The name of an existing frame section property that is a section designer section.</p>
<p class="ParameterName">ShapeName</p>
<p class="Comment">The name of an existing or new shape in a section designer property. If this is an existing shape, that shape is modified; otherwise, a new shape is added.</p>
<p class="Comment">This item may be input as a blank string, in which case the program will assign a shape name to the shape and return that name in the ShapeName variable.</p>
<p class="ParameterName">MatProp</p>
<p class="Comment">The name of the material property for the shape.</p>
<p class="ParameterName">PropName</p>
<p class="Comment">This is a blank string or the name of a defined Tube property that has been imported from a section property file.</p>
<p class="Comment">If this item is a blank string, the section dimensions are taken from the values input in this function.</p>
<p class="Comment">If this item is the name of a defined Tube property that has been imported from a section property file, the section dimensions are taken from the specified Tube property.</p>
<p class="Comment">If this item is not blank and the specified property name is not an Tube that was imported from a section property file, an error is returned.</p>
<p class="ParameterName">XCenter</p>
<p class="Comment">The X-coordinate of the center of the shape in the section designer coordinate system. [L]</p>
<p class="ParameterName">YCenter</p>
<p class="Comment">The Y-coordinate of the center of the shape in the section designer coordinate system. [L]</p>
<p class="ParameterName">Rotation</p>
<p class="Comment">The counter clockwise rotation of the shape from its default orientation. [deg]</p>
<p class="ParameterName">Color</p>
<p class="Comment">The fill color assigned to the shape. If Color is specified as -1, the program will automatically assign the default fill color.</p>
<p class="ParameterName">h</p>
<p class="Comment">The section height. [L]</p>
<p class="ParameterName">w</p>
<p class="Comment">The section width. [L]</p>
<p class="ParameterName">tf</p>
<p class="Comment">The flange thickness. [L]</p>
<p class="ParameterName">tw</p>
<p class="Comment">The web thickness. [L]</p>
<h2>Remarks</h2>
<p class="Comment">This function adds a new Tube shape or modifies an existing shape to be a Tube shape in a section designer property.</p>
<p class="Comment">The function returns zero if the shape is successfully added or modified; otherwise it returns a nonzero value.</p>
<h2>VBA Example</h2>
<p class="Coding">Sub SetFrameSDPropTube()<br>
&#160;&#160;&#160;'dimension variables<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapObject as cOAPI<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim SapModel As cSapModel<br>
&#160;&#160;&#160;&#160;&#160;&#160;Dim ret As Long<br>
<br>
&#160;&#160;&#160;'create Sap2000 object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = CreateObject("CSI.SAP2000.API.SapObject")<br>
<br>
&#160;&#160;&#160;'start Sap2000 application<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationStart<br>
<br>
&#160;&#160;&#160;'create SapModel object<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = SapObject.SapModel<br>
<br>
&#160;&#160;&#160;'initialize model<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.InitializeNewModel<br>
<br>
&#160;&#160;&#160;'create model from template<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.File.New2DFrame(PortalFrame, 2, 144, 2, 288)<br>
<br>
&#160;&#160;&#160;'add new section designer frame section property<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PropFrame.SetSDSection("SD1", "A992Fy50")<br>
<br>
&#160;&#160;&#160;'add Tube shape to new property<br>
&#160;&#160;&#160;&#160;&#160;&#160;ret = SapModel.PropFrame.SDShape.SetTube("SD1", "SH1", "A992Fy50", "", 0, -9, 0, -1, 18, 6, 1, 0.5)<br>
<br>
&#160;&#160;&#160;'close Sap2000<br>
&#160;&#160;&#160;&#160;&#160;&#160;SapObject.ApplicationExit False<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapModel = Nothing<br>
&#160;&#160;&#160;&#160;&#160;&#160;Set SapObject = Nothing<br>
End Sub</p>
<h2>Release Notes</h2>
<p class="Comment">Initial release in version 12.00.</p>
<h2>See Also</h2>
<p class="Block-Text"><a href="GetTube_{SDShape}.htm">GetTube</a></p>
</body>
</html>
