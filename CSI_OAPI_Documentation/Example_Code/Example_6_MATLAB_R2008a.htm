
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="Example5.doc">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>Example 6 (MATLAB)</title>
<link rel="StyleSheet" href="../SAP2000.CSS" type="text/css">
</head>
<body lang="EN-US" xml:lang="EN-US">
<script type="text/javascript" src="../ehlpdhtm.js"></script>

<h1>Example 6 (MATLAB)</h1>
<h2>Remarks</h2>
<p class="Comment">This example is written for MATLAB R2015a. It is based on the Sap2000 verification problem Example 1-001.</p>
<p class="Comment">This example creates the example verification problem from scratch, runs the analysis, extracts results, and compares the results with hand calculated values.</p>
<h2>Example</h2>
<ol start="1" style="list-style: decimal;">
<li class="p-Comment">
<p class="Comment" style="margin-left: 12px;">You will need to have MATLAB installed on your computer. MATLAB is a product of MathWorks and can be purchased at www.mathworks.com. Free trials are also available.</p>
</li>
<li class="p-Comment" style="color: #000000;">
<p class="Comment" style="margin-left: 12px;">Create a MATLAB .m file and paste in the following code:</p>
</li>
</ol>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% clean-up the workspace &amp; command window</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">clear;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">clc;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%%set the following flag to true to attach to an existing instance of the program otherwise a new instance of the program will be started</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">AttachToInstance = false(); % true(); %</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% set the following flag to true to manually specify the path to SAP2000.exe</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% this allows for a connection to a version of SAP2000 other than the latest installation</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% otherwise the latest installed version of SAP2000 will be launched</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">SpecifyPath = false(); % true(); %</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% if the above flag is set to true, specify the path to SAP2000 below</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ProgramPath = 'C:\Program Files\Computers and Structures\SAP2000 21\SAP2000.exe';</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% full path to API dll</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% set it to the installation folder</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">APIDLLPath = 'C:\Program Files\Computers and Structures\SAP2000 21\SAP2000v1.dll';</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% full path to the model</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% set it to the desired path of your model</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ModelDirectory = 'C:\CSiAPIexample';</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">if ~exist(ModelDirectory, 'dir')</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;mkdir(ModelDirectory);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ModelName = 'API_1-001.sdb';</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ModelPath = strcat(ModelDirectory, filesep, ModelName);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% create API helper object</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">a = NET.addAssembly(APIDLLPath);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">helper = SAP2000v1.Helper;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">helper = NET.explicitCast(helper,'SAP2000v1.cHelper');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">if AttachToInstance</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;%% attach to a running instance of Sap2000</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;SapObject = helper.GetObject('CSI.SAP2000.API.SapObject');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;SapObject = NET.explicitCast(SapObject,'SAP2000v1.cOAPI');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">else</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;if SpecifyPath</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;%% create an instance of the SapObject from the specified path</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SapObject = helper.CreateObject(ProgramPath);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;else</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;%% create an instance of the SapObject from the latest installed SAP2000</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SapObject = helper.CreateObjectProgID('CSI.SAP2000.API.SapObject');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;SapObject = NET.explicitCast(SapObject,'SAP2000v1.cOAPI');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;%% start Sap2000 application</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;SapObject.ApplicationStart;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">helper = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% create SapModel object</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">SapModel = NET.explicitCast(SapObject.SapModel,'SAP2000v1.cSapModel');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% initialize model</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = SapModel.InitializeNewModel;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% create new blank model</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">File = NET.explicitCast(SapModel.File,'SAP2000v1.cFile');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = File.NewBlank;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% define material property</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PropMaterial = NET.explicitCast(SapModel.PropMaterial,'SAP2000v1.cPropMaterial');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PropMaterial.SetMaterial('CONC', SAP2000v1.eMatType.Concrete);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign isotropic mechanical properties to material</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PropMaterial.SetMPIsotropic('CONC', 3600, 0.2, 0.0000055);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% define rectangular frame section property</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PropFrame = NET.explicitCast(SapModel.PropFrame,'SAP2000v1.cPropFrame');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PropFrame.SetRectangle('R1', 'CONC', 12, 12);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% define frame section property modifiers</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ModValue = NET.createArray('System.Double',8);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 1 : 8</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;ModValue(i) = 1;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ModValue(1) = 1000;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ModValue(2) = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ModValue(3) = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PropFrame.SetModifiers('R1', ModValue);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% switch to k-ft units</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = SapModel.SetPresentUnits(SAP2000v1.eUnits.kip_ft_F);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% add frame object by coordinates</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">FrameObj = NET.explicitCast(SapModel.FrameObj,'SAP2000v1.cFrameObj');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">FrameName1 = System.String(' ');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">FrameName2 = System.String(' ');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">FrameName3 = System.String(' ');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, FrameName1] = FrameObj.AddByCoord(0, 0, 0, 0, 0, 10, FrameName1, 'R1', '1', 'Global');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, FrameName2] = FrameObj.AddByCoord(0, 0, 10, 8, 0, 16, FrameName2, 'R1', '2', 'Global');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, FrameName3] = FrameObj.AddByCoord(-4, 0, 10, 0, 0, 10, FrameName3, 'R1', '3', 'Global');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign point object restraint at base</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointObj = NET.explicitCast(SapModel.PointObj,'SAP2000v1.cPointObj');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointName1 = System.String(' ');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointName2 = System.String(' ');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">Restraint = NET.createArray('System.Boolean',6);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 1 : 4</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;Restraint(i) = true();</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 5 : 6</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;Restraint(i) = false();</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, PointName1, PointName2] = FrameObj.GetPoints(FrameName1, PointName1, PointName2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PointObj.SetRestraint(PointName1, Restraint);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign point object restraint at top</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 1 : 2</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;Restraint(i) = true();</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 3 : 6</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;Restraint(i) = false();</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, PointName1, PointName2] = FrameObj.GetPoints(FrameName2, PointName1, PointName2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PointObj.SetRestraint(PointName2, Restraint);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% refresh view, update (initialize) zoom</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">View = NET.explicitCast(SapModel.View,'SAP2000v1.cView');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = View.RefreshView(0, false());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% add load patterns</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">LoadPatterns = NET.explicitCast(SapModel.LoadPatterns,'SAP2000v1.cLoadPatterns');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = LoadPatterns.Add('1', SAP2000v1.eLoadPatternType.Other, 1, true());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = LoadPatterns.Add('2', SAP2000v1.eLoadPatternType.Other, 0, true());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = LoadPatterns.Add('3', SAP2000v1.eLoadPatternType.Other, 0, true());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = LoadPatterns.Add('4', SAP2000v1.eLoadPatternType.Other, 0, true());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = LoadPatterns.Add('5', SAP2000v1.eLoadPatternType.Other, 0, true());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = LoadPatterns.Add('6', SAP2000v1.eLoadPatternType.Other, 0, true());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = LoadPatterns.Add('7', SAP2000v1.eLoadPatternType.Other, 0, true());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign loading for load pattern 2</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, PointName1, PointName2] = FrameObj.GetPoints(FrameName3, PointName1, PointName2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointLoadValue = NET.createArray('System.Double',6);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 1 : 6</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;PointLoadValue(i) = 0.0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointLoadValue(3) = -10;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PointObj.SetLoadForce(PointName1, '2', PointLoadValue);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = FrameObj.SetLoadDistributed(FrameName3, '2', 1, 10, 0, 1, 1.8, 1.8);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign loading for load pattern 3</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, PointName1, PointName2] = FrameObj.GetPoints(FrameName3, PointName1, PointName2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 1 : 6</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;PointLoadValue(i) = 0.0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointLoadValue(3) = -17.2;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointLoadValue(5) = -54.4;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = PointObj.SetLoadForce(PointName2, '3', PointLoadValue);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign loading for load pattern 4</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = FrameObj.SetLoadDistributed(FrameName2, '4', 1, 11, 0, 1, 2, 2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign loading for load pattern 5</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = FrameObj.SetLoadDistributed(FrameName1, '5', 1, 2, 0, 1, 2, 2, 'Local');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = FrameObj.SetLoadDistributed(FrameName2, '5', 1, 2, 0, 1, -2, -2, 'Local');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign loading for load pattern 6</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = FrameObj.SetLoadDistributed(FrameName1, '6', 1, 2, 0, 1, 0.9984, 0.3744, 'Local');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = FrameObj.SetLoadDistributed(FrameName2, '6', 1, 2, 0, 1, -0.3744, 0, 'Local');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% assign loading for load pattern 7</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = FrameObj.SetLoadPoint(FrameName2, '7', 1, 2, 0.5, -15, 'Local');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% switch to k-in units</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = SapModel.SetPresentUnits(SAP2000v1.eUnits.kip_in_F);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% save model</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = File.Save(ModelPath);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% run model (this will create the analysis model)</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">Analyze = NET.explicitCast(SapModel.Analyze,'SAP2000v1.cAnalyze');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = Analyze.RunAnalysis();</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% initialize for Sap2000 results</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">SapResult = zeros(7,1,'double');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">[ret, PointName1, PointName2] = FrameObj.GetPoints(FrameName2, PointName1, PointName2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% get Sap2000 results for load cases 1 through 7</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">AnalysisResults = NET.explicitCast(SapModel.Results,'SAP2000v1.cAnalysisResults');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">AnalysisResultsSetup = NET.explicitCast(AnalysisResults.Setup,'SAP2000v1.cAnalysisResultsSetup');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 1 : 7</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;NumberResults = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;Obj = NET.createArray('System.String',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;Elm = NET.createArray('System.String',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;ACase = NET.createArray('System.String',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;StepType = NET.createArray('System.String',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;StepNum = NET.createArray('System.Double',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;U1 = NET.createArray('System.Double',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;U2 = NET.createArray('System.Double',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;U3 = NET.createArray('System.Double',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;R1 = NET.createArray('System.Double',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;R2 = NET.createArray('System.Double',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;R3 = NET.createArray('System.Double',2);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;ret = AnalysisResultsSetup.DeselectAllCasesAndCombosForOutput;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;ret = AnalysisResultsSetup.SetCaseSelectedForOutput(int2str(i));</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;if i &lt;= 4</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[ret, NumberResults, Obj, Elm, ACase, StepType, StepNum, U1, U2, U3, R1, R2, &#160;&#160;&#160;R3] = AnalysisResults.JointDispl(PointName2, SAP2000v1.eItemTypeElm.ObjectElm, NumberResults, Obj, Elm, ACase, StepType, StepNum, U1, U2, U3, R1, R2, R3);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;SapResult(i) = U3(1);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;else</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[ret, NumberResults, Obj, Elm, ACase, StepType, StepNum, U1, U2, U3, R1, R2, R3] = AnalysisResults.JointDispl(PointName1, SAP2000v1.eItemTypeElm.ObjectElm, NumberResults, Obj, Elm, ACase, StepType, StepNum, U1, U2, U3, R1, R2, R3);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">SapResult(i) = U1(1);</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% close Sap2000</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">ret = SapObject.ApplicationExit(false());</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">File = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PropMaterial = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PropFrame = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">FrameObj = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PointObj = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">View = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">LoadPatterns = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">Analyze = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">AnalysisResults = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">AnalysisResultsSetup = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">SapModel = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">SapObject = 0;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% fill independent results</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult = zeros(7,1,'double');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult(1) = -0.02639;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult(2) = 0.06296;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult(3) = 0.06296;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult(4) = -0.2963;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult(5) = 0.3125;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult(6) = 0.11556;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult(7) = 0.00651;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% fill percent difference</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PercentDiff = zeros(7,1,'double');</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">for i = 1 : 7</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;&#160;&#160;&#160;PercentDiff(i) = (SapResult(i) / IndResult(i)) - 1;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">end</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">%% display results</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">SapResult</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">IndResult</p>
<p class="MsoNormal" style="margin-bottom: .0001pt; line-height: normal; mso-layout-grid-align: none; text-autospace: none; margin-left: 48px; font-family: 'Courier New', monospace;">PercentDiff</p>
<h2>Release Notes</h2>
<p class="Block-Text">Initial release in version 15.0.1</p>
<p class="Block-Text">&#160;</p>
<p class="Block-Text">Example 6 (MATLAB) has been updated to take advantage of MATLABs .NET interface. MATLAB users who were experiencing intermittent crashes when trying to retrieve analysis results through the API should update their client applications using the new example code as a template.</p>
</body>
</html>
