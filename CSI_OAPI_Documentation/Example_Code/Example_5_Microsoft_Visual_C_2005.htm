
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="Originator" content="ImportDoc">
<meta name="OriginalFile" content="Example6.doc">
 <meta name="generator" content="Adobe RoboHelp 2019">
<title>Example 5 (Microsoft Visual C++ 2012)</title>
<link rel="StyleSheet" href="../SAP2000.CSS" type="text/css">
</head>

<body lang="EN-US" xml:lang="EN-US">
<script type="text/javascript" src="../ehlpdhtm.js"></script>

<h1>Example 5 (Microsoft Visual C++ 2012)</h1>
<h2>Remarks</h2>
<p class="Comment">This example is written for Microsoft Visual C++ 2012. 
 It is based on the SAP2000 verification problem Example 1-001.</p>
<p class="Comment">This example creates the example verification problem 
 from scratch, runs the analysis, extracts results, and compares the results 
 with hand calculated values.</p>
<h2>Example</h2>
<ol start="1" style="list-style: decimal;">
	<li class="p-Block-Text" style="font-family: Arial, sans-serif; font-size: 10pt; 
		 color: #000000;"><p class="Comment" style="margin-left: 12px;">Create 
	 a Visual C++ Win32 project using the template “Win32 Console Application”.</p></li>
	<li class="p-Block-Text" style="font-family: Arial, sans-serif; font-size: 10pt; 
		 color: #000000;"><p class="Comment" style="margin-left: 12px;">In 
	 Win32 Application Wizard, add common header files for ATL under Application 
	 Settings tab.</p></li>
	<li class="p-Block-Text" style="font-family: Arial, sans-serif; font-size: 10pt; 
		 color: #000000;"><p class="Comment" style="margin-left: 12px;">Copy 
	 the &quot;SAP2000v1.tlb&quot; file from the SAP2000 installation folder 
	 to your project directory. It should be copied to the same level as 
	 you client application's project file.</p></li>
	<li class="p-Block-Text" style="font-family: Arial, sans-serif; font-size: 10pt; 
		 color: #000000;"><p class="Comment" style="margin-left: 12px;">Open 
	 the &quot;stdafx.h&quot; file generated by the wizard by double clicking 
	 on it and add the following line to the end of the document:</p></li>
</ol>
<p class="Coding" style="margin-left: 84px;">&#160;#include &lt;atlsafe.h&gt;</p>
<ol start="5" style="list-style: decimal;">
	<li class="p-Block-Text" style="font-family: Arial, sans-serif;"><p 
		 class="Comment" style="margin-left: 12px;">Open the .cpp file 
	 generated by the wizard by double-clicking on it and paste in the 
	 following code. Please pay attention to the comments in this code 
	 block, they contain important information about running the script.</p></li>
</ol>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">#include 
 &quot;stdafx.h&quot;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">#include 
 &lt;sstream&gt;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">#include 
 &lt;iomanip&gt;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">#include 
 &lt;math.h&gt;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">#import 
 &quot;SAP2000v1.tlb&quot; no_dual_interfaces</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">using 
 namespace std;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">bool 
 CheckHRESULT(HRESULT hRes, const wchar_t* msg)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">{</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>if (hRes 
 == S_FALSE || FAILED(hRes)) {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>MessageBox(0, 
 msg, L&quot;ERROR!&quot;, MB_SETFOREGROUND);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>return 
 (false);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>return (true);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">int 
 _tmain(int argc, _TCHAR* argv[])</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">{</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// set the 
 following flag to true to attach to an existing instance of the program</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// otherwise 
 a new instance of the program will be started</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>bool bAttachToInstance;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>bAttachToInstance 
 = false;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// set the 
 following flag to true to manually specify the path to SAP2000.exe</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// this allows 
 for a connection to a version of SAP2000 other than the latest installation</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// otherwise 
 the latest installed version of SAP2000 will be launched</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>bool bSpecifyPath;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>bSpecifyPath 
 = false;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// if the 
 above flag is set to true, specify the path to SAP2000 below</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>const wchar_t* 
 ProgramPath;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>ProgramPath 
 = L&quot;C:\\Program Files\\Computers and Structures\\SAP2000 22\\SAP2000.exe&quot;;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// full path 
 to the model</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// set it 
 to an already existing folder</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>const wchar_t* 
 ModelPath = L&quot;C:\\CSiAPIexample\\API_1-001.sdb&quot;;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// use res 
 to check if functions return successfully (res = 0) or fail (res = nonzero)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>HRESULT hRes 
 = -1;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>int res = 
 -1;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// initialize 
 COM</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>hRes = CoInitialize(NULL);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>if (!CheckHRESULT(hRes, 
 L&quot;Error initializing COM subsystem!&quot;)) return (hRes);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>//SapObject 
 pointer</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>CComPtr&lt;SAP2000v1::cOAPI&gt; 
 pSapObject;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>try {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 create Helper</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComPtr&lt;SAP2000v1::cHelper&gt; 
 pHelper;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>hRes 
 = pHelper.CoCreateInstance(L&quot;SAP2000v1.Helper&quot;, NULL, CLSCTX_INPROC_SERVER);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (!CheckHRESULT(hRes, L&quot;Cannot instantiate helper!&quot;)) return 
 (hRes);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (bAttachToInstance) {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 attach to a running instance of SAP2000</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 get the active SAPObject</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>pSapObject 
 = pHelper-&gt;GetObject(L&quot;CSI.SAP2000.API.SapObject&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>hRes 
 = ((pSapObject) ? S_OK : S_FALSE);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (!CheckHRESULT(hRes, L&quot;Cannot attach to SapObject!&quot;)) return 
 (hRes);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>else 
 {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 start a new instance of SAP2000</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (bSpecifyPath) {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 create an instance of the SapObject from the specified path</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>pSapObject 
 = pHelper-&gt;CreateObject(ProgramPath);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>hRes 
 = ((pSapObject) ? S_OK : S_FALSE);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (!CheckHRESULT(hRes, L&quot;Cannot instantiate SapObject!&quot;)) return 
 (hRes);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>else 
 {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 create an instance of the SapObject from the latest installed SAP2000</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>pSapObject 
 = pHelper-&gt;CreateObjectProgID(L&quot;CSI.SAP2000.API.SapObject&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>hRes 
 = ((pSapObject) ? S_OK : S_FALSE);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (!CheckHRESULT(hRes, L&quot;Cannot instantiate SapObject!&quot;)) return 
 (hRes);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 start SAP2000 application</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapObject-&gt;ApplicationStart(SAP2000v1::eUnits_kip_in_F, VARIANT_TRUE, 
 L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (!CheckHRESULT(hRes, L&quot;SapObject.ApplicationStart failed!&quot;)) 
 return (hRes);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 Get a reference to SapModel to access all API classes and functions</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComPtr&lt;SAP2000v1::cSapModel&gt; 
 pSapModel;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>
pSapModel = pSapObject-&gt;SapModel;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 initialize model</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;InitializeNewModel(SAP2000v1::eUnits_kip_in_F);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 create new blank model</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;File-&gt;NewBlank();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 define material property</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 bstrPropMaterial = &quot;CONC&quot;;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PropMaterial-&gt;SetMaterial(bstrPropMaterial, SAP2000v1::eMatType_Concrete, 
 -1, L&quot;&quot;, L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign isotropic mechanical properties to material</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PropMaterial-&gt;SetMPIsotropic(bstrPropMaterial, 3600, 
 0.2, 0.0000055, 0.0);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 define rectangular frame section property</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 bstrPropFrame(&quot;R1&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PropFrame-&gt;SetRectangle(bstrPropFrame, bstrPropMaterial, 
 12, 12, -1, L&quot;&quot;, L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 define frame section property modifiers</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saMod(8); // CComSafeArray is a wrapper for the SAFEARRAY structure.</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 8; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saMod[i] 
 = 1.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saMod[0] 
 = 1000.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saMod[1] 
 = 0.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saMod[2] 
 = 0.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaMod = saMod.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PropFrame-&gt;SetModifiers(bstrPropFrame, &amp;psaMod);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saMod.Attach(psaMod);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 switch to k-ft units</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;SetPresentUnits(SAP2000v1::eUnits_kip_ft_F);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 add frame object by coordinates</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>BSTR 
 name1 = ::SysAllocString(L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>BSTR 
 name2 = ::SysAllocString(L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>BSTR 
 name3 = ::SysAllocString(L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 FrameName0(&quot;1&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 FrameName1(&quot;2&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 FrameName2(&quot;3&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 bstrCoordSys(&quot;Global&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;AddByCoord(0, 0, 0, 0, 0, 10, &amp;name1, 
 bstrPropFrame, FrameName0, bstrCoordSys);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;AddByCoord(0, 0, 10, 8, 0, 16, &amp;name2, 
 bstrPropFrame, FrameName1, bstrCoordSys);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;AddByCoord(-4, 0, 10, 0, 0, 10, &amp;name3, 
 bstrPropFrame, FrameName2, bstrCoordSys);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign point object restraint at base</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>BSTR 
 PointName;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>BSTR 
 PointName0 = ::SysAllocString(L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>BSTR 
 PointName1 = ::SysAllocString(L&quot;&quot;);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;VARIANT_BOOL, 
 VT_BOOL&gt; saRest(6);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 4; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saRest[i] 
 = VARIANT_TRUE;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 4; i &lt; 6; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saRest[i] 
 = VARIANT_FALSE;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;GetPoints(FrameName0, &amp;PointName0, &amp;PointName1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaRest = saRest.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PointObj-&gt;SetRestraint(PointName0, &amp;psaRest, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saRest.Attach(psaRest);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign point object restraint at top</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 2; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saRest[i] 
 = VARIANT_TRUE;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 2; i &lt; 6; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saRest[i] 
 = VARIANT_FALSE;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;GetPoints(FrameName1, &amp;PointName0, &amp;PointName1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>psaRest 
 = saRest.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PointObj-&gt;SetRestraint(PointName1, &amp;psaRest, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saRest.Attach(psaRest);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 refresh view, update (initialize) zoom</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>long 
 window = 0;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>VARIANT_BOOL 
 zoom = VARIANT_FALSE;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;View-&gt;RefreshView(window, zoom);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 add load patterns</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>double 
 SelfWTMultiplier = 1.0;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>VARIANT_BOOL 
 AddLoadCase = VARIANT_TRUE;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;LoadPatterns-&gt;Add(&quot;1&quot;, SAP2000v1::eLoadPatternType_Other, 
 SelfWTMultiplier, AddLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>SelfWTMultiplier 
 = 0.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;LoadPatterns-&gt;Add(&quot;2&quot;, SAP2000v1::eLoadPatternType_Other, 
 SelfWTMultiplier, AddLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;LoadPatterns-&gt;Add(&quot;3&quot;, SAP2000v1::eLoadPatternType_Other, 
 SelfWTMultiplier, AddLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;LoadPatterns-&gt;Add(&quot;4&quot;, SAP2000v1::eLoadPatternType_Other, 
 SelfWTMultiplier, AddLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;LoadPatterns-&gt;Add(&quot;5&quot;, SAP2000v1::eLoadPatternType_Other, 
 SelfWTMultiplier, AddLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;LoadPatterns-&gt;Add(&quot;6&quot;, SAP2000v1::eLoadPatternType_Other, 
 SelfWTMultiplier, AddLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;LoadPatterns-&gt;Add(&quot;7&quot;, SAP2000v1::eLoadPatternType_Other, 
 SelfWTMultiplier, AddLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign loading for load pattern 2</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;GetPoints(FrameName2, &amp;PointName0, &amp;PointName1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saPLoad(6);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 6; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saPLoad[i] 
 = 0.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saPLoad[2] 
 = -10.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>bstrCoordSys 
 = L&quot;Global&quot;;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaPLoad = saPLoad.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PointObj-&gt;SetLoadForce(PointName0, &quot;2&quot;, &amp;psaPLoad, 
 VARIANT_FALSE, bstrCoordSys, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saPLoad.Attach(psaPLoad);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;SetLoadDistributed(FrameName2, &quot;2&quot;, 
 1, 10, 0., 1., 1.8, 1.8, bstrCoordSys, VARIANT_TRUE, VARIANT_TRUE, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign loading for load pattern 3</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;GetPoints(FrameName2, &amp;PointName0, &amp;PointName1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 6; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saPLoad[i] 
 = 0.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saPLoad[2] 
 = -17.2;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saPLoad[4] 
 = -54.4;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>psaPLoad 
 = saPLoad.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;PointObj-&gt;SetLoadForce(PointName1, &quot;3&quot;, &amp;psaPLoad, 
 VARIANT_FALSE, bstrCoordSys, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saPLoad.Attach(psaPLoad);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign loading for load pattern 4</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;SetLoadDistributed(FrameName1, &quot;4&quot;, 
 1, 10, 0, 1, 1.8, 1.8, bstrCoordSys, VARIANT_TRUE, VARIANT_TRUE, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign loading for load pattern 5</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>bstrCoordSys 
 = L&quot;Local&quot;;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;SetLoadDistributed(FrameName0, &quot;5&quot;, 
 1, 2, 0, 1, 2, 2, bstrCoordSys, VARIANT_TRUE, VARIANT_TRUE, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;SetLoadDistributed(FrameName1, &quot;5&quot;, 
 1, 2, 0, 1, -2, -2, bstrCoordSys, VARIANT_TRUE, VARIANT_TRUE, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign loading for load pattern 6</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;SetLoadDistributed(FrameName0, &quot;6&quot;, 
 1, 2, 0, 1, 0.9984, 0.3744, bstrCoordSys, VARIANT_TRUE, VARIANT_TRUE, 
 SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;SetLoadDistributed(FrameName1, &quot;6&quot;, 
 1, 2, 0, 1, -0.3744, 0, bstrCoordSys, VARIANT_TRUE, VARIANT_TRUE, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 assign loading for load pattern 7</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;SetLoadPoint(FrameName1, &quot;7&quot;, 1, 
 2, 0.5, -15, bstrCoordSys, VARIANT_TRUE, VARIANT_TRUE, SAP2000v1::eItemType_Objects);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 switch to k-in units</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;SetPresentUnits(SAP2000v1::eUnits_kip_in_F);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 save model</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 bstrFileName(ModelPath);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;File-&gt;Save(bstrFileName);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 run model (this will create the analysis model)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;Analyze-&gt;RunAnalysis();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 initialize for Sap2000 results</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>long 
 NumberResults = 0;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>double 
 SapResult[7];</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 7; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>SapResult[i] 
 = 0.;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;BSTR&gt; 
 saResObj(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;BSTR&gt; 
 saResElm(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;BSTR&gt; 
 saResLoadCase(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;BSTR&gt; 
 saResStepType(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saResStepNum(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saResU1(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saResU2(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saResU3(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saResR1(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saResR2(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CComSafeArray&lt;double&gt; 
 saResR3(1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;FrameObj-&gt;GetPoints(FrameName1, &amp;PointName0, &amp;PointName1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 get Sap2000 results for load cases 1 through 7</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 7; i++) {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;Results-&gt;Setup-&gt;DeselectAllCasesAndCombosForOutput();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>_bstr_t 
 bstrLoadPattern = std::to_string(i + 1).c_str();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;Results-&gt;Setup-&gt;SetCaseSelectedForOutput(bstrLoadPattern, 
 VARIANT_TRUE);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>PointName 
 = (i &lt;= 3) ? PointName1 : PointName0;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 result arrays get reallocated inside the response call so we have to detach 
 first</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResObj = saResObj.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResElm = saResElm.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResLoadCase = saResLoadCase.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResStepType = saResStepType.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResStepNum = saResStepNum.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResU1 = saResU1.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResU2 = saResU2.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResU3 = saResU3.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResR1 = saResR1.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResR2 = saResR2.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>LPSAFEARRAY 
 psaResR3 = saResR3.Detach();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapModel-&gt;Results-&gt;JointDispl(PointName, SAP2000v1::eItemTypeElm_ObjectElm, 
 &amp;NumberResults,</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&amp;psaResObj, 
 &amp;psaResElm, &amp;psaResLoadCase, &amp;psaResStepType, &amp;psaResStepNum,</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&amp;psaResU1, 
 &amp;psaResU2, &amp;psaResU3, &amp;psaResR1, &amp;psaResR2, &amp;psaResR3);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>//re-attach 
 to the result arrays</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResObj.Attach(psaResObj);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResElm.Attach(psaResElm);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResLoadCase.Attach(psaResLoadCase);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResStepType.Attach(psaResStepType);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResStepNum.Attach(psaResStepNum);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResU1.Attach(psaResU1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResU2.Attach(psaResU2);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResU3.Attach(psaResU3);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResR1.Attach(psaResR1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResR2.Attach(psaResR2);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>saResR3.Attach(psaResR3);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>if 
 (i &lt;= 3)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>SapResult[i] 
 = saResU3[0];</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>else</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 4;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>SapResult[i] 
 = saResU1[0];</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 close Sap2000 application</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = pSapObject-&gt;ApplicationExit(VARIANT_FALSE);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 fill independent results (hand calculated)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>double 
 IndResult[7];</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>IndResult[0] 
 = -0.02639;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>IndResult[1] 
 = 0.06296;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>IndResult[2] 
 = 0.06296;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>IndResult[3] 
 = -0.2963;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>IndResult[4] 
 = 0.3125;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>IndResult[5] 
 = 0.11556;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>IndResult[6] 
 = 0.00651;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 fill percent difference</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>double 
 PercentDiff[7];</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 7; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>PercentDiff[i] 
 = fabs((SapResult[i] / IndResult[i]) - 1);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>// 
 print results</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>stringstream 
 sMsg;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>sMsg 
 &lt;&lt; fixed &lt;&lt; setfill(' ');</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>sMsg 
 &lt;&lt; &quot;LC Sap2000<span style="mso-spacerun: yes;">&#160;&#160;&#160;&#160;</span>&#160;Independent 
 % Diff&quot; &lt;&lt; endl;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>for 
 (int i = 0; i &lt; 7; i++)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>sMsg 
 &lt;&lt; setprecision(5) &lt;&lt; showpoint &lt;&lt; setiosflags(ios::left)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&lt;&lt; 
 setw(2) &lt;&lt; i + 1 &lt;&lt; &quot; &quot;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&lt;&lt; 
 setw(11) &lt;&lt; IndResult[i] &lt;&lt; &quot; &quot;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&lt;&lt; 
 setw(11) &lt;&lt; SapResult[i] &lt;&lt; &quot; &quot;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&lt;&lt; 
 setprecision(0) &lt;&lt; noshowpoint &lt;&lt; setiosflags(ios::right)</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 3;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>&lt;&lt; 
 setw(5) &lt;&lt; PercentDiff[i] &lt;&lt; '%' &lt;&lt; endl;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>MessageBoxA(0, 
 sMsg.str().c_str(), &quot; Results&quot;, MB_SETFOREGROUND);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>catch (_com_error&amp; 
 ex) {</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>CheckHRESULT(ex.Error(), 
 ex.ErrorMessage());</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 2;">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span>res 
 = -1;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>}</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>CoUninitialize();</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">&#160;</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>// we're 
 done!</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;"><span 
	 style="mso-tab-count: 1;">&#160;&#160;&#160;&#160;</span>return (res);</p>
<p class="MsoNormal" style="font-family: 'Courier New', monospace;">}</p>
<h2 class="MsoNormal">Release Notes</h2>
<p class="Block-Text">Initial release in version 15.0.1</p>
<p class="Block-Text">Updated in version 22.1.0.</p>
</body>
</html>
